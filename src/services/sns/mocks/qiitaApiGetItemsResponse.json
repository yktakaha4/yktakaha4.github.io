[
  {
    "rendered_body": "<p>ã“ã¡ã‚‰ã¯ã€<a href=\"https://qiita.com/advent-calendar/2020/lambda\">AWS Lambdaã¨Serverless Advent Calendar 2020</a> 25æ—¥ç›®ã®è¨˜äº‹ã«ãªã‚Šã¾ã™ï¼</p>\n\n<p>ã‚¯ãƒªã‚¹ãƒã‚¹ã®å…¬é–‹ã§ã™ãŒå­£ç¯€æ„Ÿã¯ãªã„ã§ã™<br>\næ‚ªã—ã‹ã‚‰ãšğŸ¦µ</p>\n\n<h1>\n<span id=\"ã¯ã˜ã‚ã«\" class=\"fragment\"></span><a href=\"#%E3%81%AF%E3%81%98%E3%82%81%E3%81%AB\"><i class=\"fa fa-link\"></i></a>ã¯ã˜ã‚ã«</h1>\n\n<p>AWS re:Invent 2020ã«ã¦<a href=\"https://aws.amazon.com/jp/blogs/news/new-for-aws-lambda-container-image-support/\" rel=\"nofollow noopener\" target=\"_blank\">Lambdaã®ã‚³ãƒ³ãƒ†ãƒŠã‚¤ãƒ¡ãƒ¼ã‚¸ã®ã‚µãƒãƒ¼ãƒˆ</a>ãŒç™ºè¡¨ã•ã‚Œã¾ã—ãŸãŒã€<br>\næˆ‘ã‚‰ãŒæ„›ã™ã‚‹Serverless Frameworkã§ã‚‚æ—©ã€…ã«<a href=\"https://github.com/serverless/serverless/issues/8570\" rel=\"nofollow noopener\" target=\"_blank\">ã‚µãƒãƒ¼ãƒˆãŒè¡Œã‚ã‚ŒãŸ</a>ã®ã§ã€ãŠè©¦ã—ã§ä½¿ã£ã¦ã¿ã¾ã—ãŸğŸ„</p>\n\n<p><code>serverless.yml</code> ã«ãŠã‘ã‚‹å®šç¾©ã«ã¤ã„ã¦ã¯ã€<a href=\"https://www.serverless.com/blog/container-support-for-lambda\" rel=\"nofollow noopener\" target=\"_blank\">ã“ã¡ã‚‰</a>ã®ãƒ–ãƒ­ã‚°ã«ã‚ã‚‹é€šã‚Šã€ <code>&lt;account&gt;.dkr.ecr.&lt;region&gt;.amazonaws.com/&lt;repository&gt;@&lt;digest&gt;</code> ã®å½¢å¼ã§æŒ‡å®šã™ã‚‹å¿…è¦ãŒã‚ã‚‹ãã†ã§ã™<br>\nã‚¿ã‚°ã§ãªãã€ã‚¤ãƒ¡ãƒ¼ã‚¸ã®ãƒ€ã‚¤ã‚¸ã‚§ã‚¹ãƒˆã§æŒ‡å®šã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã¨ã®ã“ã¨ãªã®ã§ã€ <code>sls deploy</code> æ™‚ã«ã„ã„æ„Ÿã˜ã«æ³¨å…¥ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ğŸ¥›</p>\n\n<h1>\n<span id=\"ä½œã£ãŸã‚‚ã®\" class=\"fragment\"></span><a href=\"#%E4%BD%9C%E3%81%A3%E3%81%9F%E3%82%82%E3%81%AE\"><i class=\"fa fa-link\"></i></a>ä½œã£ãŸã‚‚ã®</h1>\n\n<p>ä»¥ä¸‹ã§å…¬é–‹ã—ã¦ã„ã¾ã™ğŸ™<br>\n<a href=\"https://github.com/yktakaha4/lambda-docker-serverless\" class=\"autolink\" rel=\"nofollow noopener\" target=\"_blank\">https://github.com/yktakaha4/lambda-docker-serverless</a></p>\n\n<p>ãªã‚‹ã¹ãç°¡å˜ã«å‹•ä½œã‚’è©¦ã›ã‚‹ã‚ˆã†ã«ã€<br>\nç’°å¢ƒæ§‹ç¯‰ã‹ã‚‰ãƒ‡ãƒ—ãƒ­ã‚¤ã¾ã§ã«å¿…è¦ãªã‚‚ã‚ã‚‚ã‚ã‚’GitHub Actionsã«<a href=\"https://github.com/yktakaha4/lambda-docker-serverless/blob/master/.github/workflows/deployment.yml\" rel=\"nofollow noopener\" target=\"_blank\">ã¾ã¨ã‚ã¦ã¾ã™</a><br>\nå¤‰æ›´ã™ã¹ãç®‡æ‰€ã¯READMEã«ã¾ã¨ã‚ã¦ã„ã¾ã™ã®ã§ä½µã›ã¦ã”è¦§ãã ã•ã„</p>\n\n<h1>\n<span id=\"ãƒã‚¤ãƒ³ãƒˆ\" class=\"fragment\"></span><a href=\"#%E3%83%9D%E3%82%A4%E3%83%B3%E3%83%88\"><i class=\"fa fa-link\"></i></a>ãƒã‚¤ãƒ³ãƒˆ</h1>\n\n<p>Dockerãƒ•ã‚¡ã‚¤ãƒ«ã¯ã€ <code>public.ecr.aws/lambda/xxxxx</code> ã‹ã‚‰ä½œæˆã™ã‚‹å¿…è¦ãŒã‚ã‚‹ãã†ã§ã™<br>\n<a href=\"https://github.com/aws/aws-lambda-base-images\" rel=\"nofollow noopener\" target=\"_blank\">ã“ã¡ã‚‰</a>ã«ã¦ãƒ™ãƒ¼ã‚¹ã‚¤ãƒ¡ãƒ¼ã‚¸ãŒå…¬é–‹ã•ã‚Œã¦ã„ã¾ã™ğŸ‹</p>\n\n<p>ã‚ã¨ã€å¾“æ¥ã¯ <code>serverless.yml</code> ã«ã¦é–¢æ•°ã®ã‚¨ãƒ³ãƒˆãƒªãƒ¼ãƒã‚¤ãƒ³ãƒˆã‚’è¨­å®šã—ã¦ã„ãŸã‚‚ã®ã¨æ€ã„ã¾ã™ãŒã€Dockerfileã«ã¦è¨­å®šã—ã¦ãŠãå¿…è¦ãŒã‚ã‚‹ã‚ˆã†ã§ã™<br>\nå€‹äººçš„ã«ã€ECSã®Scheduled Taskã§å˜ä¸€ã®ã‚³ãƒ³ãƒ†ãƒŠã«è¤‡æ•°ã®é–¢æ•°ã‚’å«ã‚ã¦ã€å®šç¾©ã”ã¨ã«å‹•ã‹ã™ã‚‚ã®ã‚’å¤‰ãˆã‚‹ã¨ã„ã†ã“ã¨ã‚’ã‚„ã£ã¦ã„ãŸã®ã§ã™ãŒã€ç¾çŠ¶ã ã¨å€‹åˆ¥ã«ãƒ“ãƒ«ãƒ‰ã—ã¦ãŠãå¿…è¦ãŒã‚ã‚‹æ„Ÿã˜ãªã®ã§ã—ã‚‡ã†ã‹...ï¼Ÿ</p>\n\n<div class=\"code-frame\" data-lang=\"dockerfile\">\n<div class=\"code-lang\"><span class=\"bold\">Dockerfile</span></div>\n<div class=\"highlight\"><pre><code><span class=\"k\">FROM</span><span class=\"s\"> public.ecr.aws/lambda/nodejs:12 AS builder</span>\n\n<span class=\"k\">WORKDIR</span><span class=\"s\"> /opt/build</span>\n\n<span class=\"k\">COPY</span><span class=\"s\"> . .</span>\n\n<span class=\"k\">RUN </span>npm ci\n\n<span class=\"k\">RUN </span>npm run build\n\n<span class=\"c\">##### ##### ##### #####</span>\n<span class=\"k\">FROM</span><span class=\"s\"> public.ecr.aws/lambda/nodejs:12 AS runner</span>\n\n<span class=\"k\">COPY</span><span class=\"s\"> --from=builder \\</span>\n  /opt/build/package*.json \\\n  ./\n\n<span class=\"k\">COPY</span><span class=\"s\"> --from=builder \\</span>\n  /opt/build/dist \\\n  ./dist\n\n<span class=\"k\">RUN </span>npm ci <span class=\"nt\">--only</span><span class=\"o\">=</span>production\n\n<span class=\"c\"># !!! ã“ã“ãƒã‚¤ãƒ³ãƒˆ !!!</span>\n<span class=\"k\">CMD</span><span class=\"s\"> [\"dist/index.handler\"]</span>\n</code></pre></div>\n</div>\n\n<p>ã‚¤ãƒ¡ãƒ¼ã‚¸ã®ãƒ“ãƒ«ãƒ‰ã¨ECRã¸ã®ãƒ—ãƒƒã‚·ãƒ¥ãŒæ¸ˆã‚“ã ã‚‰ã€ã‚¤ãƒ¡ãƒ¼ã‚¸ã®ãƒ€ã‚¤ã‚¸ã‚§ã‚¹ãƒˆã‚’å–å¾—ã—ã€ <code>sls</code> ã‚³ãƒãƒ³ãƒ‰ã«æ¸¡ã›ã‚‹ã‚ˆã†ã«ç’°å¢ƒå¤‰æ•°ã«è¨­å®šã—ã¾ã™<br>\nå¾“æ¥ã® <code>set-env</code> ã¯ç¾åœ¨ç„¡åŠ¹ã¨ãªã£ã¦ã„ã‚‹ã®ã§ã€<a href=\"https://qiita.com/shonansurvivors/items/f256a0443d346f09448e\" id=\"reference-c1315afcf044466efc3e\">æ–°ã—ã„æ›¸ãæ–¹</a>ã§ã‚„ã£ã¦ã¾ã™</p>\n\n<p>ã‚ã¨ã€ä»Šå›åˆã‚ã¦çŸ¥ã£ãŸã®ã§ã™ãŒã€GitHub Actionsã®ç’°å¢ƒã«ã¯ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ <code>aws</code> ã‚³ãƒãƒ³ãƒ‰ãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã‚‹ã‚“ã§ã™ã­...ï¼</p>\n\n<div class=\"code-frame\" data-lang=\"yaml\">\n<div class=\"code-lang\"><span class=\"bold\">deployment.yml(æŠœç²‹)</span></div>\n<div class=\"highlight\"><pre><code><span class=\"na\">jobs</span><span class=\"pi\">:</span>\n  <span class=\"na\">deploy</span><span class=\"pi\">:</span>\n    <span class=\"na\">runs-on</span><span class=\"pi\">:</span> <span class=\"s\">ubuntu-18.04</span>\n    <span class=\"na\">timeout-minutes</span><span class=\"pi\">:</span> <span class=\"m\">300</span>\n\n    <span class=\"na\">steps</span><span class=\"pi\">:</span>\n      <span class=\"c1\"># ç•¥</span>\n\n      <span class=\"c1\"># ECR</span>\n      <span class=\"pi\">-</span> <span class=\"na\">uses</span><span class=\"pi\">:</span> <span class=\"s\">aws-actions/amazon-ecr-login@v1</span>\n        <span class=\"na\">id</span><span class=\"pi\">:</span> <span class=\"s\">login-ecr</span>\n\n      <span class=\"pi\">-</span> <span class=\"na\">run</span><span class=\"pi\">:</span> <span class=\"pi\">|</span>\n          <span class=\"s\">docker build -t $REGISTRY/$REPOSITORY:$TAG .</span>\n          <span class=\"s\">docker push $REGISTRY/$REPOSITORY:$TAG</span>\n\n          <span class=\"s\"># !!! ã“ã“ãƒã‚¤ãƒ³ãƒˆ !!!</span>\n          <span class=\"s\">echo \"IMAGE_DIGEST=$(aws ecr describe-images --repository-name $REPOSITORY --image-ids imageTag=$TAG --output text --query 'imageDetails[0].imageDigest')\" &gt;&gt; $GITHUB_ENV</span>\n        <span class=\"na\">env</span><span class=\"pi\">:</span>\n          <span class=\"na\">REGISTRY</span><span class=\"pi\">:</span> <span class=\"s\">${{ steps.login-ecr.outputs.registry }}</span>\n          <span class=\"na\">REPOSITORY</span><span class=\"pi\">:</span> <span class=\"s\">lambda-docker-serverless-repos</span>\n          <span class=\"na\">TAG</span><span class=\"pi\">:</span> <span class=\"s\">latest</span>\n\n      <span class=\"c1\"># Serverless Framework</span>\n      <span class=\"pi\">-</span> <span class=\"na\">run</span><span class=\"pi\">:</span> <span class=\"s\">npm ci</span>\n\n      <span class=\"pi\">-</span> <span class=\"na\">run</span><span class=\"pi\">:</span> <span class=\"s\">npm run deploy</span>\n        <span class=\"na\">env</span><span class=\"pi\">:</span>\n          <span class=\"na\">AWS_ACCESS_KEY_ID</span><span class=\"pi\">:</span> <span class=\"s\">${{ secrets.AWS_ACCESS_KEY_ID }}</span>\n          <span class=\"na\">AWS_SECRET_ACCESS_KEY</span><span class=\"pi\">:</span> <span class=\"s\">${{ secrets.AWS_SECRET_ACCESS_KEY }}</span>\n          <span class=\"na\">AWS_DEFAULT_REGION</span><span class=\"pi\">:</span> <span class=\"s\">${{ secrets.AWS_DEFAULT_REGION }}</span>\n          <span class=\"na\">IMAGE_DIGEST</span><span class=\"pi\">:</span> <span class=\"s\">${{ env.IMAGE_DIGEST }}</span>\n</code></pre></div>\n</div>\n\n<p><code>serverless.yml</code> ã§ã¯ã€å¾“æ¥ <code>handler</code> ã‚’ä½¿ã£ã¦ã„ãŸã¨ã“ã‚ã‚’ã€ <code>image</code> ã§ã‚³ãƒ³ãƒ†ãƒŠã‚’æŒ‡å®šã—ã¾ã™<br>\n<code>#{AWS::AccountId}</code> ãªã©ã€ã‚·ãƒ£ãƒ¼ãƒ—ã§å§‹ã¾ã‚‹ã‚‚ã®ã¯ <a href=\"https://www.serverless.com/plugins/serverless-pseudo-parameters\" rel=\"nofollow noopener\" target=\"_blank\">serverless-pseudo-parameters</a>ã®åƒãã«ã‚ˆã‚Šå®Ÿå€¤ãŒåŸ‹ã‚è¾¼ã¾ã‚Œã¾ã™</p>\n\n<div class=\"code-frame\" data-lang=\"yml\">\n<div class=\"code-lang\"><span class=\"bold\">serverless.yml</span></div>\n<div class=\"highlight\"><pre><code><span class=\"na\">service</span><span class=\"pi\">:</span> <span class=\"s\">lambda-docker-serverless</span>\n\n<span class=\"na\">provider</span><span class=\"pi\">:</span>\n  <span class=\"na\">name</span><span class=\"pi\">:</span> <span class=\"s\">aws</span>\n  <span class=\"na\">stage</span><span class=\"pi\">:</span> <span class=\"s\">prod</span>\n  <span class=\"na\">region</span><span class=\"pi\">:</span> <span class=\"s\">${env:AWS_DEFAULT_REGION}</span>\n  <span class=\"na\">deploymentBucket</span><span class=\"pi\">:</span> <span class=\"s\">lambda-docker-serverless-deployment</span>\n\n<span class=\"na\">functions</span><span class=\"pi\">:</span>\n  <span class=\"na\">index</span><span class=\"pi\">:</span>\n    <span class=\"c1\"># !!! ã“ã“ãƒã‚¤ãƒ³ãƒˆ !!!</span>\n    <span class=\"na\">image</span><span class=\"pi\">:</span> <span class=\"s2\">\"</span><span class=\"s\">#{AWS::AccountId}.dkr.ecr.#{AWS::Region}.amazonaws.com/lambda-docker-serverless-repos@${env:IMAGE_DIGEST}\"</span>\n    <span class=\"na\">events</span><span class=\"pi\">:</span>\n      <span class=\"pi\">-</span> <span class=\"na\">http</span><span class=\"pi\">:</span>\n          <span class=\"na\">path</span><span class=\"pi\">:</span> <span class=\"s\">index</span>\n          <span class=\"na\">method</span><span class=\"pi\">:</span> <span class=\"s\">post</span>\n          <span class=\"na\">cors</span><span class=\"pi\">:</span> <span class=\"no\">true</span>\n\n<span class=\"na\">plugins</span><span class=\"pi\">:</span>\n  <span class=\"pi\">-</span> <span class=\"s\">serverless-pseudo-parameters</span>\n</code></pre></div>\n</div>\n\n<p>ä»Šå›ã¯ã€ã“ã‚“ãªã‚·ãƒ³ãƒ—ãƒ«ãªé–¢æ•°ã‚’ä½œã£ã¦ã¿ã¾ã—ãŸ<br>\nãƒªã‚¯ã‚¨ã‚¹ãƒˆã§å—ã‘å–ã£ãŸåå‰ã‚’å¤§æ–‡å­—ã«ã—ã¦ã€æŒ¨æ‹¶ã‚’è¿”ã™å‡¦ç†ã«ãªã‚Šã¾ã™ğŸ‘‹</p>\n\n<div class=\"code-frame\" data-lang=\"typescript\">\n<div class=\"code-lang\"><span class=\"bold\">index.ts</span></div>\n<div class=\"highlight\"><pre><code><span class=\"k\">import</span> <span class=\"p\">{</span> <span class=\"nx\">APIGatewayProxyHandler</span> <span class=\"p\">}</span> <span class=\"k\">from</span> <span class=\"dl\">\"</span><span class=\"s2\">aws-lambda</span><span class=\"dl\">\"</span><span class=\"p\">;</span>\n<span class=\"k\">import</span> <span class=\"dl\">\"</span><span class=\"s2\">source-map-support/register</span><span class=\"dl\">\"</span><span class=\"p\">;</span>\n\n<span class=\"kr\">interface</span> <span class=\"nx\">Request</span> <span class=\"p\">{</span>\n  <span class=\"nl\">name</span><span class=\"p\">?:</span> <span class=\"kr\">string</span><span class=\"p\">;</span>\n<span class=\"p\">}</span>\n\n<span class=\"k\">export</span> <span class=\"kd\">const</span> <span class=\"nx\">handler</span><span class=\"p\">:</span> <span class=\"nx\">APIGatewayProxyHandler</span> <span class=\"o\">=</span> <span class=\"k\">async</span> <span class=\"p\">(</span><span class=\"nx\">event</span><span class=\"p\">)</span> <span class=\"o\">=&gt;</span> <span class=\"p\">{</span>\n  <span class=\"k\">try</span> <span class=\"p\">{</span>\n    <span class=\"kd\">const</span> <span class=\"p\">{</span> <span class=\"nx\">name</span> <span class=\"p\">}</span> <span class=\"o\">=</span> <span class=\"nx\">JSON</span><span class=\"p\">.</span><span class=\"nx\">parse</span><span class=\"p\">(</span><span class=\"nx\">event</span><span class=\"p\">.</span><span class=\"nx\">body</span> <span class=\"o\">??</span> <span class=\"dl\">\"</span><span class=\"s2\">{}</span><span class=\"dl\">\"</span><span class=\"p\">)</span> <span class=\"k\">as</span> <span class=\"nx\">Request</span><span class=\"p\">;</span>\n\n    <span class=\"k\">return</span> <span class=\"p\">{</span>\n      <span class=\"na\">statusCode</span><span class=\"p\">:</span> <span class=\"mi\">200</span><span class=\"p\">,</span>\n      <span class=\"na\">body</span><span class=\"p\">:</span> <span class=\"nx\">JSON</span><span class=\"p\">.</span><span class=\"nx\">stringify</span><span class=\"p\">({</span>\n        <span class=\"na\">message</span><span class=\"p\">:</span> <span class=\"s2\">`Hello, </span><span class=\"p\">${(</span><span class=\"nx\">name</span> <span class=\"o\">??</span> <span class=\"dl\">\"</span><span class=\"s2\">nanashi-san</span><span class=\"dl\">\"</span><span class=\"p\">).</span><span class=\"nx\">toUpperCase</span><span class=\"p\">()}</span><span class=\"s2\"> !`</span><span class=\"p\">,</span>\n      <span class=\"p\">}),</span>\n    <span class=\"p\">};</span>\n  <span class=\"p\">}</span> <span class=\"k\">catch</span> <span class=\"p\">(</span><span class=\"nx\">e</span><span class=\"p\">)</span> <span class=\"p\">{</span>\n    <span class=\"k\">return</span> <span class=\"p\">{</span>\n      <span class=\"na\">statusCode</span><span class=\"p\">:</span> <span class=\"mi\">500</span><span class=\"p\">,</span>\n      <span class=\"na\">body</span><span class=\"p\">:</span> <span class=\"nx\">JSON</span><span class=\"p\">.</span><span class=\"nx\">stringify</span><span class=\"p\">({</span>\n        <span class=\"na\">error</span><span class=\"p\">:</span> <span class=\"nb\">String</span><span class=\"p\">(</span><span class=\"nx\">e</span><span class=\"p\">),</span>\n      <span class=\"p\">}),</span>\n    <span class=\"p\">};</span>\n  <span class=\"p\">}</span>\n<span class=\"p\">};</span>\n</code></pre></div>\n</div>\n\n<p><code>https://xxxxxxxx.execute-api.ap-northeast-1.amazonaws.com/prod/index</code> ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã¦ã¿ã¾ã™<br>\n<a href=\"https://insomnia.rest/\" rel=\"nofollow noopener\" target=\"_blank\">Insomnia</a>ã§å®Ÿè¡Œã—ã¦ã¿ã‚‹ã¨ã€ã¡ã‚ƒã‚“ã¨å‹•ã„ã¦ãã†ã§ã„ã„æ„Ÿã˜ã§ã™ï¼</p>\n\n<p><a href=\"https://camo.qiitausercontent.com/2d982fe092527fe455771a709acd3b6aa30fa838/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3130363235392f61346233643061332d373537342d656131612d333736312d3465333632613864313266342e706e67\" target=\"_blank\" rel=\"nofollow noopener\"><img src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F106259%2Fa4b3d0a3-7574-ea1a-3761-4e362a8d12f4.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=7b09ac2fae9cf50c3681940c4681cf7d\" alt=\"insomnia.png\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/106259/a4b3d0a3-7574-ea1a-3761-4e362a8d12f4.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F106259%2Fa4b3d0a3-7574-ea1a-3761-4e362a8d12f4.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=11066bd857f5f9a10a21d5e463a86c1c 1x\" loading=\"lazy\"></a></p>\n\n<h1>\n<span id=\"ãŠã‚ã‚Šã«\" class=\"fragment\"></span><a href=\"#%E3%81%8A%E3%82%8F%E3%82%8A%E3%81%AB\"><i class=\"fa fa-link\"></i></a>ãŠã‚ã‚Šã«</h1>\n\n<p>å½“åˆã¯ã€é–¢æ•°å†…ã§<a href=\"https://pptr.dev/\" rel=\"nofollow noopener\" target=\"_blank\">Puppeteer</a>ã‚’å‹•ã‹ãã†ã¨å°‘ã—è©¦ã—ã¦ã„ãŸã®ã§ã™ãŒã€<br>\nå¾“æ¥ã®ä¸€ç•ªå®‰å®šã—ãŸã‚„ã‚Šæ–¹ã ã£ãŸ<a href=\"https://github.com/alixaxel/chrome-aws-lambda\" rel=\"nofollow noopener\" target=\"_blank\">chrome-aws-lambda</a>ã‚’ä½¿ã†ã‚ˆã‚Šã‚‚æ¥½ã«æ§‹ç¯‰ã§ãã‚‹ã¨æ€ã„ãã‚„ã€ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®ä¸è¶³ã‚„ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®æ¨©é™å‘¨ã‚Šã®å•é¡Œã§çµæ§‹ç•™æ„ã™ã‚‹ã“ã¨ãŒå¤šã‹ã£ãŸã®ã§è«¦ã‚ã¾ã—ãŸ...<br>\nï¼ˆã¡ãªãã®æ®‹éª¸ã¯<a href=\"https://github.com/yktakaha4/lambda-docker-puppeteer\" rel=\"nofollow noopener\" target=\"_blank\">ã“ã¡ã‚‰</a>ã«ã‚ã‚Šã¾ã™âš°ï¸ï¼‰</p>\n\n<p>å¾“æ¥å®Ÿè¡Œç’°å¢ƒã®å¾®å¦™ãªå·®ç•°ã«æ‚©ã¾ã•ã‚Œã‚‹ã“ã¨ã‚‚ã¡ã‚‡ã„ã¡ã‚‡ã„ã‚ã£ãŸã‚ˆã†ã«æ€ã„ã¾ã™ãŒã€<br>\nä»Šå¾Œã‚³ãƒ³ãƒ†ãƒŠãƒ™ãƒ¼ã‚¹ã®ç’°å¢ƒã§é–‹ç™ºãŒã§ãã‚‹ã‚ˆã†ã«ãªã‚‹ã¨åˆ©ä¾¿æ€§ãŒä¸ŠãŒã‚‹ã®ã§ã€å¼•ãç¶šãå‹•å‘ã‚’è¿½ã£ã¦ã„ããŸã„ã§ã™ã­ğŸ¦ŒğŸ¦ŒğŸ…ğŸ</p>\n",
    "body": "ã“ã¡ã‚‰ã¯ã€[AWS Lambdaã¨Serverless Advent Calendar 2020](https://qiita.com/advent-calendar/2020/lambda) 25æ—¥ç›®ã®è¨˜äº‹ã«ãªã‚Šã¾ã™ï¼\n\nã‚¯ãƒªã‚¹ãƒã‚¹ã®å…¬é–‹ã§ã™ãŒå­£ç¯€æ„Ÿã¯ãªã„ã§ã™\næ‚ªã—ã‹ã‚‰ãšğŸ¦µ\n\n# ã¯ã˜ã‚ã«\n\nAWS re:Invent 2020ã«ã¦[Lambdaã®ã‚³ãƒ³ãƒ†ãƒŠã‚¤ãƒ¡ãƒ¼ã‚¸ã®ã‚µãƒãƒ¼ãƒˆ](https://aws.amazon.com/jp/blogs/news/new-for-aws-lambda-container-image-support/)ãŒç™ºè¡¨ã•ã‚Œã¾ã—ãŸãŒã€\næˆ‘ã‚‰ãŒæ„›ã™ã‚‹Serverless Frameworkã§ã‚‚æ—©ã€…ã«[ã‚µãƒãƒ¼ãƒˆãŒè¡Œã‚ã‚ŒãŸ](https://github.com/serverless/serverless/issues/8570)ã®ã§ã€ãŠè©¦ã—ã§ä½¿ã£ã¦ã¿ã¾ã—ãŸğŸ„\n\n`serverless.yml` ã«ãŠã‘ã‚‹å®šç¾©ã«ã¤ã„ã¦ã¯ã€[ã“ã¡ã‚‰](https://www.serverless.com/blog/container-support-for-lambda)ã®ãƒ–ãƒ­ã‚°ã«ã‚ã‚‹é€šã‚Šã€ `<account>.dkr.ecr.<region>.amazonaws.com/<repository>@<digest>` ã®å½¢å¼ã§æŒ‡å®šã™ã‚‹å¿…è¦ãŒã‚ã‚‹ãã†ã§ã™\nã‚¿ã‚°ã§ãªãã€ã‚¤ãƒ¡ãƒ¼ã‚¸ã®ãƒ€ã‚¤ã‚¸ã‚§ã‚¹ãƒˆã§æŒ‡å®šã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã¨ã®ã“ã¨ãªã®ã§ã€ `sls deploy` æ™‚ã«ã„ã„æ„Ÿã˜ã«æ³¨å…¥ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ğŸ¥›\n\n# ä½œã£ãŸã‚‚ã®\n\nä»¥ä¸‹ã§å…¬é–‹ã—ã¦ã„ã¾ã™ğŸ™\nhttps://github.com/yktakaha4/lambda-docker-serverless\n\nãªã‚‹ã¹ãç°¡å˜ã«å‹•ä½œã‚’è©¦ã›ã‚‹ã‚ˆã†ã«ã€\nç’°å¢ƒæ§‹ç¯‰ã‹ã‚‰ãƒ‡ãƒ—ãƒ­ã‚¤ã¾ã§ã«å¿…è¦ãªã‚‚ã‚ã‚‚ã‚ã‚’GitHub Actionsã«[ã¾ã¨ã‚ã¦ã¾ã™](https://github.com/yktakaha4/lambda-docker-serverless/blob/master/.github/workflows/deployment.yml)\nå¤‰æ›´ã™ã¹ãç®‡æ‰€ã¯READMEã«ã¾ã¨ã‚ã¦ã„ã¾ã™ã®ã§ä½µã›ã¦ã”è¦§ãã ã•ã„\n\n# ãƒã‚¤ãƒ³ãƒˆ\n\nDockerãƒ•ã‚¡ã‚¤ãƒ«ã¯ã€ `public.ecr.aws/lambda/xxxxx` ã‹ã‚‰ä½œæˆã™ã‚‹å¿…è¦ãŒã‚ã‚‹ãã†ã§ã™\n[ã“ã¡ã‚‰](https://github.com/aws/aws-lambda-base-images)ã«ã¦ãƒ™ãƒ¼ã‚¹ã‚¤ãƒ¡ãƒ¼ã‚¸ãŒå…¬é–‹ã•ã‚Œã¦ã„ã¾ã™ğŸ‹\n\nã‚ã¨ã€å¾“æ¥ã¯ `serverless.yml` ã«ã¦é–¢æ•°ã®ã‚¨ãƒ³ãƒˆãƒªãƒ¼ãƒã‚¤ãƒ³ãƒˆã‚’è¨­å®šã—ã¦ã„ãŸã‚‚ã®ã¨æ€ã„ã¾ã™ãŒã€Dockerfileã«ã¦è¨­å®šã—ã¦ãŠãå¿…è¦ãŒã‚ã‚‹ã‚ˆã†ã§ã™\nå€‹äººçš„ã«ã€ECSã®Scheduled Taskã§å˜ä¸€ã®ã‚³ãƒ³ãƒ†ãƒŠã«è¤‡æ•°ã®é–¢æ•°ã‚’å«ã‚ã¦ã€å®šç¾©ã”ã¨ã«å‹•ã‹ã™ã‚‚ã®ã‚’å¤‰ãˆã‚‹ã¨ã„ã†ã“ã¨ã‚’ã‚„ã£ã¦ã„ãŸã®ã§ã™ãŒã€ç¾çŠ¶ã ã¨å€‹åˆ¥ã«ãƒ“ãƒ«ãƒ‰ã—ã¦ãŠãå¿…è¦ãŒã‚ã‚‹æ„Ÿã˜ãªã®ã§ã—ã‚‡ã†ã‹...ï¼Ÿ\n\n```dockerfile:Dockerfile\nFROM public.ecr.aws/lambda/nodejs:12 AS builder\n\nWORKDIR /opt/build\n\nCOPY . .\n\nRUN npm ci\n\nRUN npm run build\n\n##### ##### ##### #####\nFROM public.ecr.aws/lambda/nodejs:12 AS runner\n\nCOPY --from=builder \\\n  /opt/build/package*.json \\\n  ./\n\nCOPY --from=builder \\\n  /opt/build/dist \\\n  ./dist\n\nRUN npm ci --only=production\n\n# !!! ã“ã“ãƒã‚¤ãƒ³ãƒˆ !!!\nCMD [\"dist/index.handler\"]\n```\n\nã‚¤ãƒ¡ãƒ¼ã‚¸ã®ãƒ“ãƒ«ãƒ‰ã¨ECRã¸ã®ãƒ—ãƒƒã‚·ãƒ¥ãŒæ¸ˆã‚“ã ã‚‰ã€ã‚¤ãƒ¡ãƒ¼ã‚¸ã®ãƒ€ã‚¤ã‚¸ã‚§ã‚¹ãƒˆã‚’å–å¾—ã—ã€ `sls` ã‚³ãƒãƒ³ãƒ‰ã«æ¸¡ã›ã‚‹ã‚ˆã†ã«ç’°å¢ƒå¤‰æ•°ã«è¨­å®šã—ã¾ã™\nå¾“æ¥ã® `set-env` ã¯ç¾åœ¨ç„¡åŠ¹ã¨ãªã£ã¦ã„ã‚‹ã®ã§ã€[æ–°ã—ã„æ›¸ãæ–¹](https://qiita.com/shonansurvivors/items/f256a0443d346f09448e)ã§ã‚„ã£ã¦ã¾ã™\n\nã‚ã¨ã€ä»Šå›åˆã‚ã¦çŸ¥ã£ãŸã®ã§ã™ãŒã€GitHub Actionsã®ç’°å¢ƒã«ã¯ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ `aws` ã‚³ãƒãƒ³ãƒ‰ãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã‚‹ã‚“ã§ã™ã­...ï¼\n\n```yaml:deployment.yml(æŠœç²‹)\njobs:\n  deploy:\n    runs-on: ubuntu-18.04\n    timeout-minutes: 300\n\n    steps:\n      # ç•¥\n\n      # ECR\n      - uses: aws-actions/amazon-ecr-login@v1\n        id: login-ecr\n\n      - run: |\n          docker build -t $REGISTRY/$REPOSITORY:$TAG .\n          docker push $REGISTRY/$REPOSITORY:$TAG\n\n          # !!! ã“ã“ãƒã‚¤ãƒ³ãƒˆ !!!\n          echo \"IMAGE_DIGEST=$(aws ecr describe-images --repository-name $REPOSITORY --image-ids imageTag=$TAG --output text --query 'imageDetails[0].imageDigest')\" >> $GITHUB_ENV\n        env:\n          REGISTRY: ${{ steps.login-ecr.outputs.registry }}\n          REPOSITORY: lambda-docker-serverless-repos\n          TAG: latest\n\n      # Serverless Framework\n      - run: npm ci\n\n      - run: npm run deploy\n        env:\n          AWS_ACCESS_KEY_ID: ${{ secrets.AWS_ACCESS_KEY_ID }}\n          AWS_SECRET_ACCESS_KEY: ${{ secrets.AWS_SECRET_ACCESS_KEY }}\n          AWS_DEFAULT_REGION: ${{ secrets.AWS_DEFAULT_REGION }}\n          IMAGE_DIGEST: ${{ env.IMAGE_DIGEST }}\n```\n\n`serverless.yml` ã§ã¯ã€å¾“æ¥ `handler` ã‚’ä½¿ã£ã¦ã„ãŸã¨ã“ã‚ã‚’ã€ `image` ã§ã‚³ãƒ³ãƒ†ãƒŠã‚’æŒ‡å®šã—ã¾ã™\n`#{AWS::AccountId}` ãªã©ã€ã‚·ãƒ£ãƒ¼ãƒ—ã§å§‹ã¾ã‚‹ã‚‚ã®ã¯ [serverless-pseudo-parameters]\n(https://www.serverless.com/plugins/serverless-pseudo-parameters)ã®åƒãã«ã‚ˆã‚Šå®Ÿå€¤ãŒåŸ‹ã‚è¾¼ã¾ã‚Œã¾ã™\n\n```yml:serverless.yml\nservice: lambda-docker-serverless\n\nprovider:\n  name: aws\n  stage: prod\n  region: ${env:AWS_DEFAULT_REGION}\n  deploymentBucket: lambda-docker-serverless-deployment\n\nfunctions:\n  index:\n    # !!! ã“ã“ãƒã‚¤ãƒ³ãƒˆ !!!\n    image: \"#{AWS::AccountId}.dkr.ecr.#{AWS::Region}.amazonaws.com/lambda-docker-serverless-repos@${env:IMAGE_DIGEST}\"\n    events:\n      - http:\n          path: index\n          method: post\n          cors: true\n\nplugins:\n  - serverless-pseudo-parameters\n```\n\nä»Šå›ã¯ã€ã“ã‚“ãªã‚·ãƒ³ãƒ—ãƒ«ãªé–¢æ•°ã‚’ä½œã£ã¦ã¿ã¾ã—ãŸ\nãƒªã‚¯ã‚¨ã‚¹ãƒˆã§å—ã‘å–ã£ãŸåå‰ã‚’å¤§æ–‡å­—ã«ã—ã¦ã€æŒ¨æ‹¶ã‚’è¿”ã™å‡¦ç†ã«ãªã‚Šã¾ã™ğŸ‘‹\n\n```typescript:index.ts\nimport { APIGatewayProxyHandler } from \"aws-lambda\";\nimport \"source-map-support/register\";\n\ninterface Request {\n  name?: string;\n}\n\nexport const handler: APIGatewayProxyHandler = async (event) => {\n  try {\n    const { name } = JSON.parse(event.body ?? \"{}\") as Request;\n\n    return {\n      statusCode: 200,\n      body: JSON.stringify({\n        message: `Hello, ${(name ?? \"nanashi-san\").toUpperCase()} !`,\n      }),\n    };\n  } catch (e) {\n    return {\n      statusCode: 500,\n      body: JSON.stringify({\n        error: String(e),\n      }),\n    };\n  }\n};\n```\n\n`https://xxxxxxxx.execute-api.ap-northeast-1.amazonaws.com/prod/index` ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã¦ã¿ã¾ã™\n[Insomnia](https://insomnia.rest/)ã§å®Ÿè¡Œã—ã¦ã¿ã‚‹ã¨ã€ã¡ã‚ƒã‚“ã¨å‹•ã„ã¦ãã†ã§ã„ã„æ„Ÿã˜ã§ã™ï¼\n\n![insomnia.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/106259/a4b3d0a3-7574-ea1a-3761-4e362a8d12f4.png)\n\n# ãŠã‚ã‚Šã«\n\nå½“åˆã¯ã€é–¢æ•°å†…ã§[Puppeteer](https://pptr.dev/)ã‚’å‹•ã‹ãã†ã¨å°‘ã—è©¦ã—ã¦ã„ãŸã®ã§ã™ãŒã€\nå¾“æ¥ã®ä¸€ç•ªå®‰å®šã—ãŸã‚„ã‚Šæ–¹ã ã£ãŸ[chrome-aws-lambda](https://github.com/alixaxel/chrome-aws-lambda)ã‚’ä½¿ã†ã‚ˆã‚Šã‚‚æ¥½ã«æ§‹ç¯‰ã§ãã‚‹ã¨æ€ã„ãã‚„ã€ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®ä¸è¶³ã‚„ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®æ¨©é™å‘¨ã‚Šã®å•é¡Œã§çµæ§‹ç•™æ„ã™ã‚‹ã“ã¨ãŒå¤šã‹ã£ãŸã®ã§è«¦ã‚ã¾ã—ãŸ...\nï¼ˆã¡ãªãã®æ®‹éª¸ã¯[ã“ã¡ã‚‰](https://github.com/yktakaha4/lambda-docker-puppeteer)ã«ã‚ã‚Šã¾ã™âš°ï¸ï¼‰\n\nå¾“æ¥å®Ÿè¡Œç’°å¢ƒã®å¾®å¦™ãªå·®ç•°ã«æ‚©ã¾ã•ã‚Œã‚‹ã“ã¨ã‚‚ã¡ã‚‡ã„ã¡ã‚‡ã„ã‚ã£ãŸã‚ˆã†ã«æ€ã„ã¾ã™ãŒã€\nä»Šå¾Œã‚³ãƒ³ãƒ†ãƒŠãƒ™ãƒ¼ã‚¹ã®ç’°å¢ƒã§é–‹ç™ºãŒã§ãã‚‹ã‚ˆã†ã«ãªã‚‹ã¨åˆ©ä¾¿æ€§ãŒä¸ŠãŒã‚‹ã®ã§ã€å¼•ãç¶šãå‹•å‘ã‚’è¿½ã£ã¦ã„ããŸã„ã§ã™ã­ğŸ¦ŒğŸ¦ŒğŸ…ğŸ\n",
    "coediting": false,
    "comments_count": 0,
    "created_at": "2020-12-18T03:25:49+09:00",
    "group": null,
    "id": "ead117870617f45c70d5",
    "likes_count": 3,
    "private": false,
    "reactions_count": 0,
    "stocks_count": 1,
    "tags": [
      {
        "name": "TypeScript",
        "versions": []
      },
      {
        "name": "Docker",
        "versions": []
      },
      {
        "name": "lambda",
        "versions": []
      },
      {
        "name": "ServerlessFramework",
        "versions": []
      },
      {
        "name": "GitHubActions",
        "versions": []
      }
    ],
    "title": "Serverless Frameworkã§Lambdaã‚³ãƒ³ãƒ†ãƒŠã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’åˆ©ç”¨ã™ã‚‹",
    "updated_at": "2020-12-25T07:02:42+09:00",
    "url": "https://qiita.com/yktakaha4/items/ead117870617f45c70d5",
    "user": {
      "description": "",
      "facebook_id": "",
      "followees_count": 26,
      "followers_count": 22,
      "github_login_name": "yktakaha4",
      "id": "yktakaha4",
      "items_count": 27,
      "linkedin_id": "",
      "location": "",
      "name": "Yuuki Takahashi",
      "organization": "LAPRASæ ªå¼ä¼šç¤¾",
      "permanent_id": 106259,
      "profile_image_url": "https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/106259/profile-images/1600489516",
      "team_only": false,
      "twitter_screen_name": "yktakaha4",
      "website_url": "https://yktakaha4.github.io/"
    },
    "page_views_count": null,
    "team_membership": null,
    "organization_url_name": null,
    "slide": false
  },
  {
    "rendered_body": "<p>ã“ã¡ã‚‰ã¯ã€<a href=\"https://qiita.com/advent-calendar/2020/typescript\">TypeScript Advent Calendar 2020</a> 14æ—¥ç›®ã®è¨˜äº‹ã«ãªã‚Šã¾ã™ï¼</p>\n\n<h1>\n<span id=\"ã¯ã˜ã‚ã«\" class=\"fragment\"></span><a href=\"#%E3%81%AF%E3%81%98%E3%82%81%E3%81%AB\"><i class=\"fa fa-link\"></i></a>ã¯ã˜ã‚ã«</h1>\n\n<p>æœ€è¿‘ã€å€‹äººã§ã®é–‹ç™ºã«ã¦TypeScriptã‚’é¸å®šã™ã‚‹ã“ã¨ãŒå¤šããªã‚Šã€ãã®ä¸­ã§ <a href=\"https://nestjs.com/\" rel=\"nofollow noopener\" target=\"_blank\">NestJS</a> ã‚’ä½¿ã£ã¦ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã®APIã‚’æ§‹ç¯‰ã™ã‚‹æ©Ÿä¼šãŒã‚ã£ãŸã®ã§ã™ãŒã€<br>\nãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ï¼ˆ<a href=\"https://ja.nuxtjs.org/\" rel=\"nofollow noopener\" target=\"_blank\">Nuxt.js</a>ã§ä½œã£ãŸSPAï¼‰ã¨ã®é€šä¿¡ã«ã¤ã„ã¦ã€å‰²ã¨ã„ã„æ„Ÿã˜ã«ä½œã‚ŒãŸæ°—ãŒã—ãŸã®ã§ã€å‚™å¿˜éŒ²ã¨ã—ã¦æ®‹ã—ãŸã„ã¨æ€ã„ã¾ã™âœï¸</p>\n\n<h1>\n<span id=\"ã©ã‚“ãªã‚‚ã®ã‚’ä½œã‚‹ã‹\" class=\"fragment\"></span><a href=\"#%E3%81%A9%E3%82%93%E3%81%AA%E3%82%82%E3%81%AE%E3%82%92%E4%BD%9C%E3%82%8B%E3%81%8B\"><i class=\"fa fa-link\"></i></a>ã©ã‚“ãªã‚‚ã®ã‚’ä½œã‚‹ã‹</h1>\n\n<p>Webã‚¢ãƒ—ãƒªã®ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã¨ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰é–“ã§ã®é€šä¿¡ã¨ã—ã¦ã€ä»¥ä¸‹ã®ã“ã¨ã‚’å®Ÿç¾ã—ãŸã„ã¨ã„ã†æ°—æŒã¡ãŒã‚ã‚Šã¾ã—ãŸ</p>\n\n<ul>\n<li>\n<code>ãƒªã‚¯ã‚¨ã‚¹ãƒˆ/ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã«å‹ä»˜ã‘</code> ã—ãŸã„ğŸ’ª\n\n<ul>\n<li>ãƒ•ãƒ­ãƒ³ãƒˆ/ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰åŒæ–¹ã®TSã§ã€Interfaceãªã‚ŠClassãªã‚Šã«å€¤ãŒè©°ã‚ã‚‰ã‚ŒãŸDTOã‚’æ‰±ã„ãŸã„</li>\n<li>ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰å´ã§å®šç¾©ã—ãŸå‹ã‚’ãƒ•ãƒ­ãƒ³ãƒˆå´ã§ã‚‚ä½¿ã„ãŸã„\n\n<ul>\n<li>I/Fã®æ›´æ–°ã‚’ãƒ•ãƒ­ãƒ³ãƒˆå´ã‹ã‚‰ã„ã„æ„Ÿã˜ã«å–ã‚Šè¾¼ã¿ãŸã„</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>ãƒ•ãƒ­ãƒ³ãƒˆã®ã‚³ãƒ¼ãƒ‰ä¸Šã§<code>APIã§ã‚ã‚‹ã“ã¨ã‚’æ„è­˜ã—ãŸããªã„</code> ğŸª¨\n\n<ul>\n<li>ãƒ‘ã‚¹ã¨ã‹HTTPãƒ¡ã‚½ãƒƒãƒ‰ã¨ã‹ã¯éš è”½ã—ã¦ã€TSä¸Šã§ã¯é–¢æ•°å‘¼ã³å‡ºã—ã§ä½¿ã„ãŸã„</li>\n<li>ãŸã ã—ã€Cookieã«ã‚ˆã‚‹ã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç†ã‚„ç’°å¢ƒæ¯ã«ãƒªã‚¯ã‚¨ã‚¹ãƒˆå…ˆã®ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚’åˆ†ã‘ã‚‹ãªã©ã€å¿…è¦ãŒã‚ã‚Œã°HTTPä¸Šã®æŒ™å‹•ã‚’ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã—ãŸã„</li>\n</ul>\n</li>\n<li>\n<code>ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚„æ¥­å‹™ã‚¨ãƒ©ãƒ¼ã‚’è¿”å´</code> ã—ãŸã„ğŸŸ\n\n<ul>\n<li>é …ç›®æ¯ã®ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ã—ãŸã„\n\n<ul>\n<li>ãƒ•ãƒ­ãƒ³ãƒˆã§ã‚‚ã‚ˆã—ãªã«ã‚„ã‚‹ãŒã€ç‰¹ã«ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰å´ã§æœŸå¾…ã—ãªã„ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’å—ã‘ãŸã‚‰ã‚¨ãƒ©ãƒ¼ã¨ã—ãŸã„</li>\n</ul>\n</li>\n<li>æ¥­å‹™ã‚¨ãƒ©ãƒ¼ã‚’ã„ã„æ„Ÿã˜ã«è¿”å´ã—ãŸã„\n\n<ul>\n<li>IDã«ç´ã¥ãã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãŒDBã‹ã‚‰å–ã‚Œãªã‹ã£ãŸ...ã¨ã‹</li>\n<li>1å›ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã«å¯¾ã—ã¦Nå€‹ã®æ¥­å‹™ã‚¨ãƒ©ãƒ¼ã‚’è¿”ã—ãŸã„\n\n<ul>\n<li>è¿”ã•ã‚ŒãŸæ¥­å‹™ã‚¨ãƒ©ãƒ¼ã‚’ãƒ•ãƒ­ãƒ³ãƒˆå´ã§è­˜åˆ¥ã—ã€å‡¦ç†ï¼ˆã‚¨ãƒ©ãƒ¼è¡¨ç¤ºã€ç„¡è¦–ãªã©ï¼‰ã‚’ãŠã“ãªã„ãŸã„</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¨ãƒ©ãƒ¼ç­‰ã¯ä¾‹å¤–ã§ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ã—ãŸã„</li>\n</ul>\n</li>\n</ul>\n\n<p>ä¸Šè¨˜ã®å®Ÿç¾ã«ã‚ãŸã‚ŠNestJSã®å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’ã¿ã¦ã„ãã¨ã€ <a href=\"https://docs.nestjs.com/openapi/introduction\" rel=\"nofollow noopener\" target=\"_blank\">OpenAPI</a> ã®ç« ã®è¨˜è¿°ãŒå½¹ç«‹ã¡ãã†ã§ã™ãŒã€<br>\nã‚„ã£ã¦ãã‚Œã‚‹ã®ã¯OpenAPIã®å®šç¾©ã‚’ç”Ÿæˆã—ã¦ãã‚Œã‚‹ã¨ã“ã‚ã¾ã§ãªã®ã§ã€ãã“ã‹ã‚‰APIã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã®ä½œæˆã¨ã€ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰å´ã‹ã‚‰ã®èª­ã¿è¾¼ã¿ã‚’ã©ã®ã‚ˆã†ã«è¡Œã†ã‹æ¤œè¨ã—ã¾ã—ãŸ</p>\n\n<p>ãªãŠã€æœ¬ã‚¢ãƒ‰ãƒ™ãƒ³ãƒˆã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã§ã‚‚å‹å®‰å…¨ãªé€šä¿¡ã®æ–¹æ³•ã¨ã—ã¦ <a href=\"https://qiita.com/mikan3rd/items/3f46b1edcb79ad63deef\" id=\"reference-e0bccdf12305ce2e49db\">GraphQLã‚’ä½¿ã£ãŸãƒ‘ã‚¿ãƒ¼ãƒ³</a> ã‚’æ›¸ã‹ã‚Œã¦ã„ã‚‹æ–¹ãŒã„ã¾ã™ã®ã§ã€ä½µã›ã¦ã”è¦§ã„ãŸã ãã¨æ¯”è¼ƒãŒã§ãã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“<br>\nï¼ˆç§ã¯ã€é–‹ç™ºæ™‚ã«GraphQLã«å¯¾ã™ã‚‹çŸ¥è¦‹ãŒãªã‹ã£ãŸã®ã¨ã€ä½œã‚ŠãŸã„ã‚‚ã®ã«å¯¾ã—ã¦ã‚ªãƒ¼ãƒãƒ¼ã‚¹ãƒšãƒƒã‚¯æ°—å‘³ã«æ„Ÿã˜ãŸãŸã‚ä»Šå›ã¯æ¡ç”¨ã‚’è¦‹é€ã‚Šã¾ã—ãŸï¼‰</p>\n\n<h1>\n<span id=\"ä½œã£ãŸã‚‚ã®\" class=\"fragment\"></span><a href=\"#%E4%BD%9C%E3%81%A3%E3%81%9F%E3%82%82%E3%81%AE\"><i class=\"fa fa-link\"></i></a>ä½œã£ãŸã‚‚ã®</h1>\n\n<p>ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã¯ä»¥ä¸‹ã«ãªã‚Šã¾ã™ğŸ”<br>\nã‚µãƒ³ãƒ—ãƒ«ã«ãªã‚Šãã†ãªéƒ¨åˆ†ã®ã¿æŠœãå‡ºã—ã¦ã„ã¾ã™<br>\n<a href=\"https://github.com/yktakaha4/nestjs-typed-client\" class=\"autolink\" rel=\"nofollow noopener\" target=\"_blank\">https://github.com/yktakaha4/nestjs-typed-client</a></p>\n\n<p><code>/backend</code> ã«NestJSã§ä½œã£ãŸãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã€ <code>/frontend</code> ã«Reactã§ä½œã£ãŸãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã®ã‚µãƒ³ãƒ—ãƒ«ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’æ ¼ç´ã—ã¦ã„ã¾ã™<br>\nå®Ÿéš›ã«ä½œã£ãŸã‚‚ã®ã§ã¯åˆ¥ã€…ã®ãƒªãƒã‚¸ãƒˆãƒªã«ã¦ç®¡ç†ã—ã¦ã„ã¾ã™ãŒã€ä»Šå›ã¯ç°¡ä¾¿ã®ãŸã‚ã²ã¨ã¤ã«ã¾ã¨ã‚ã¾ã—ãŸ</p>\n\n<p>ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã®ç”Ÿæˆã‹ã‚‰ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã®å–ã‚Šè¾¼ã¿ã‚’å›³ã«ã—ãŸã‚‚ã®ã¯ä»¥ä¸‹ã«ãªã‚Šã¾ã™ğŸ¦‘<br>\nã‚°ãƒ¬ãƒ¼ã®ç‚¹ç·šãŒã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã®é–¢é€£ã€ã‚ªãƒ¬ãƒ³ã‚¸ã®ç‚¹ç·šãŒå®Ÿéš›ã®é€šä¿¡ã®é–¢é€£ã®ã‚¤ãƒ¡ãƒ¼ã‚¸ã§ã™</p>\n\n<p><a href=\"https://camo.qiitausercontent.com/463178918345172373a0f3c783bacd2ce16759a4/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3130363235392f66363764363830392d303465352d373332332d333136372d3635643234613337383764332e706e67\" target=\"_blank\" rel=\"nofollow noopener\"><img src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F106259%2Ff67d6809-04e5-7323-3167-65d24a3787d3.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=98ac88464063a5ce5e32041410fa91fb\" alt=\"archtecture.png\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/106259/f67d6809-04e5-7323-3167-65d24a3787d3.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F106259%2Ff67d6809-04e5-7323-3167-65d24a3787d3.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=c2774507eccef55585b2cfe284b2c2f6 1x\" loading=\"lazy\"></a></p>\n\n<p>æµã‚Œã¯ã“ã‚“ãªæ„Ÿã˜ã«ãªã‚Šã¾ã™<br>\nãªãŠã€ä»Šå›ã¯ 2.ã§ç”Ÿæˆã™ã‚‹ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã« <code>typescript-axios</code> ã‚’é¸æŠã—ã¾ã—ãŸãŒã€ <a href=\"https://github.com/OpenAPITools/openapi-generator/tree/master/docs/generators#client-generators\" rel=\"nofollow noopener\" target=\"_blank\">ã“ã¡ã‚‰</a> ã«è¨˜è¼‰ã•ã‚Œã¦ã„ã‚‹ã‚‚ã®ã‹ã‚‰ä»»æ„ã«é¸æŠå¯èƒ½ã§ã™</p>\n\n<ol>\n<li>NestJSã«ã¦ <a href=\"https://github.com/nestjs/swagger\" rel=\"nofollow noopener\" target=\"_blank\">@nestjs/swagger</a> ã«ã¦ã‚¢ãƒãƒ†ãƒ¼ãƒˆã—ãŸDTOã¨ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã‚’å®šç¾©ã—ã€OpenAPIã®yamlãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç”Ÿæˆã™ã‚‹</li>\n<li>\n<a href=\"https://github.com/OpenAPITools/openapi-generator-cli\" rel=\"nofollow noopener\" target=\"_blank\">@openapitools/openapi-generator-cli</a> ã«ã¦ã€1.ã§ä½œæˆã—ãŸyamlãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰TypeScriptã®APIã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚’ç”Ÿæˆã™ã‚‹</li>\n<li>GitHub Actionsã‚’ç”¨ã„ã¦ã€tagãŒpushã•ã‚ŒãŸï¼ˆâ‰’Releaseã‚’ä½œæˆã—ãŸï¼‰æ™‚ã€APIã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚’tscã«ã¦ãƒ“ãƒ«ãƒ‰ã— <code>GitHub Packages Registry</code> ã«ç™»éŒ²ã™ã‚‹</li>\n<li>ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã‹ã‚‰ <code>npm install @xxxxx/sample-backend-client</code> ã®å½¢ã§èª­ã¿è¾¼ã‚“ã§åˆ©ç”¨ã™ã‚‹</li>\n</ol>\n\n<h2>\n<span id=\"ã‚¢ãƒãƒ†ãƒ¼ãƒˆã—ãŸdtoã¨ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã®å®šç¾©\" class=\"fragment\"></span><a href=\"#%E3%82%A2%E3%83%8E%E3%83%86%E3%83%BC%E3%83%88%E3%81%97%E3%81%9Fdto%E3%81%A8%E3%82%A8%E3%83%B3%E3%83%89%E3%83%9D%E3%82%A4%E3%83%B3%E3%83%88%E3%81%AE%E5%AE%9A%E7%BE%A9\"><i class=\"fa fa-link\"></i></a>ã‚¢ãƒãƒ†ãƒ¼ãƒˆã—ãŸDTOã¨ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã®å®šç¾©</h2>\n\n<p>ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰å´ã§ä»¥ä¸‹ã®ã‚ˆã†ã«ãƒªã‚¯ã‚¨ã‚¹ãƒˆã€ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’å®šç¾©ã—ã¾ã™<br>\né•·ããªã‚‹ã®ã§ä¸€éƒ¨ã®ã¿æŠœç²‹ã—ã¾ã™ãŒã€ã‚¨ãƒ©ãƒ¼ã‚¯ãƒ©ã‚¹ã¯<a href=\"https://github.com/yktakaha4/nestjs-typed-client/blob/master/backend/src/app.error.ts\" rel=\"nofollow noopener\" target=\"_blank\">ã“ã¡ã‚‰</a>ã®ã‚ˆã†ã«å®šç¾©ã—ã¦ã„ã¾ã™</p>\n\n<div class=\"code-frame\" data-lang=\"typescript\">\n<div class=\"code-lang\"><span class=\"bold\">ã‚¨ãƒ©ãƒ¼ã‚¯ãƒ©ã‚¹ã®å®šç¾©ï¼ˆãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ï¼‰</span></div>\n<div class=\"highlight\"><pre><code><span class=\"k\">export</span> <span class=\"kd\">class</span> <span class=\"nx\">EmptyNameError</span> <span class=\"p\">{</span>\n  <span class=\"c1\">// ç©ºã®åå‰ã‚’ç¤ºã™ã‚¨ãƒ©ãƒ¼ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ</span>\n\n  <span class=\"p\">@</span><span class=\"nd\">ApiProperty</span><span class=\"p\">({</span> <span class=\"na\">enum</span><span class=\"p\">:</span> <span class=\"nx\">EmptyNameErrorType</span> <span class=\"p\">})</span>\n  <span class=\"k\">readonly</span> <span class=\"kd\">type</span> <span class=\"o\">=</span> <span class=\"nx\">EmptyNameErrorType</span><span class=\"p\">.</span><span class=\"nx\">Value</span><span class=\"p\">;</span>\n\n  <span class=\"p\">@</span><span class=\"nd\">ApiProperty</span><span class=\"p\">({</span> <span class=\"na\">enum</span><span class=\"p\">:</span> <span class=\"nx\">GreetParameter</span> <span class=\"p\">})</span>\n  <span class=\"k\">readonly</span> <span class=\"nx\">parameter</span><span class=\"p\">:</span> <span class=\"nx\">GreetParameter</span><span class=\"p\">;</span>\n\n  <span class=\"kd\">constructor</span><span class=\"p\">(</span><span class=\"nx\">parameter</span><span class=\"p\">:</span> <span class=\"nx\">GreetParameter</span><span class=\"p\">)</span> <span class=\"p\">{</span>\n    <span class=\"k\">this</span><span class=\"p\">.</span><span class=\"nx\">parameter</span> <span class=\"o\">=</span> <span class=\"nx\">parameter</span><span class=\"p\">;</span>\n  <span class=\"p\">}</span>\n<span class=\"p\">}</span>\n\n<span class=\"k\">export</span> <span class=\"kd\">class</span> <span class=\"nx\">VulgarNameError</span> <span class=\"p\">{</span>\n  <span class=\"c1\">// ä¸‹å“ãªåå‰ã‚’ç¤ºã™ã‚¨ãƒ©ãƒ¼ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ</span>\n\n  <span class=\"p\">@</span><span class=\"nd\">ApiProperty</span><span class=\"p\">({</span> <span class=\"na\">enum</span><span class=\"p\">:</span> <span class=\"nx\">VulgarNameErrorType</span> <span class=\"p\">})</span>\n  <span class=\"k\">readonly</span> <span class=\"kd\">type</span> <span class=\"o\">=</span> <span class=\"nx\">VulgarNameErrorType</span><span class=\"p\">.</span><span class=\"nx\">Value</span><span class=\"p\">;</span>\n\n  <span class=\"p\">@</span><span class=\"nd\">ApiProperty</span><span class=\"p\">({</span> <span class=\"na\">enum</span><span class=\"p\">:</span> <span class=\"nx\">GreetParameter</span> <span class=\"p\">})</span>\n  <span class=\"k\">readonly</span> <span class=\"nx\">parameter</span><span class=\"p\">:</span> <span class=\"nx\">GreetParameter</span><span class=\"p\">;</span>\n\n  <span class=\"p\">@</span><span class=\"nd\">ApiProperty</span><span class=\"p\">()</span>\n  <span class=\"k\">readonly</span> <span class=\"nx\">vulgarWord</span><span class=\"p\">:</span> <span class=\"kr\">string</span><span class=\"p\">;</span>\n\n  <span class=\"kd\">constructor</span><span class=\"p\">(</span><span class=\"nx\">parameter</span><span class=\"p\">:</span> <span class=\"nx\">GreetParameter</span><span class=\"p\">,</span> <span class=\"nx\">vulgarWord</span><span class=\"p\">:</span> <span class=\"kr\">string</span><span class=\"p\">)</span> <span class=\"p\">{</span>\n    <span class=\"k\">this</span><span class=\"p\">.</span><span class=\"nx\">parameter</span> <span class=\"o\">=</span> <span class=\"nx\">parameter</span><span class=\"p\">;</span>\n    <span class=\"k\">this</span><span class=\"p\">.</span><span class=\"nx\">vulgarWord</span> <span class=\"o\">=</span> <span class=\"nx\">vulgarWord</span><span class=\"p\">;</span>\n  <span class=\"p\">}</span>\n<span class=\"p\">}</span>\n\n<span class=\"k\">export</span> <span class=\"kd\">type</span> <span class=\"nx\">GreetErrors</span> <span class=\"o\">=</span> <span class=\"nb\">Array</span><span class=\"o\">&lt;</span><span class=\"nx\">EmptyNameError</span> <span class=\"o\">|</span> <span class=\"nx\">VulgarNameError</span><span class=\"o\">&gt;</span><span class=\"p\">;</span>\n</code></pre></div>\n</div>\n\n<div class=\"code-frame\" data-lang=\"typescript\">\n<div class=\"code-lang\"><span class=\"bold\">ã‚¯ãƒ©ã‚¹ã¸ã®ã‚¢ãƒãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ï¼‰</span></div>\n<div class=\"highlight\"><pre><code><span class=\"k\">export</span> <span class=\"kd\">class</span> <span class=\"nx\">GreetRequest</span> <span class=\"p\">{</span>\n  <span class=\"p\">@</span><span class=\"nd\">ApiProperty</span><span class=\"p\">()</span>\n  <span class=\"k\">readonly</span> <span class=\"nx\">lastName</span><span class=\"p\">:</span> <span class=\"kr\">string</span><span class=\"p\">;</span>\n\n  <span class=\"p\">@</span><span class=\"nd\">ApiProperty</span><span class=\"p\">()</span>\n  <span class=\"k\">readonly</span> <span class=\"nx\">firstName</span><span class=\"p\">:</span> <span class=\"kr\">string</span><span class=\"p\">;</span>\n\n  <span class=\"kd\">constructor</span><span class=\"p\">(</span><span class=\"nx\">lastName</span><span class=\"p\">:</span> <span class=\"kr\">string</span><span class=\"p\">,</span> <span class=\"nx\">firstName</span><span class=\"p\">:</span> <span class=\"kr\">string</span><span class=\"p\">)</span> <span class=\"p\">{</span>\n    <span class=\"k\">this</span><span class=\"p\">.</span><span class=\"nx\">lastName</span> <span class=\"o\">=</span> <span class=\"nx\">lastName</span><span class=\"p\">;</span>\n    <span class=\"k\">this</span><span class=\"p\">.</span><span class=\"nx\">firstName</span> <span class=\"o\">=</span> <span class=\"nx\">firstName</span><span class=\"p\">;</span>\n  <span class=\"p\">}</span>\n<span class=\"p\">}</span>\n\n<span class=\"p\">@</span><span class=\"nd\">ApiExtraModels</span><span class=\"p\">(</span><span class=\"nx\">EmptyNameError</span><span class=\"p\">,</span> <span class=\"nx\">VulgarNameError</span><span class=\"p\">)</span>\n<span class=\"k\">export</span> <span class=\"kd\">class</span> <span class=\"nx\">GreetResponse</span> <span class=\"p\">{</span>\n  <span class=\"p\">@</span><span class=\"nd\">ApiProperty</span><span class=\"p\">({</span> <span class=\"na\">type</span><span class=\"p\">:</span> <span class=\"nb\">String</span><span class=\"p\">,</span> <span class=\"na\">nullable</span><span class=\"p\">:</span> <span class=\"kc\">true</span> <span class=\"p\">})</span>\n  <span class=\"k\">readonly</span> <span class=\"nx\">message</span><span class=\"p\">:</span> <span class=\"kr\">string</span> <span class=\"o\">|</span> <span class=\"kc\">null</span><span class=\"p\">;</span>\n\n  <span class=\"p\">@</span><span class=\"nd\">ApiProperty</span><span class=\"p\">({</span>\n    <span class=\"na\">type</span><span class=\"p\">:</span> <span class=\"dl\">'</span><span class=\"s1\">array</span><span class=\"dl\">'</span><span class=\"p\">,</span>\n    <span class=\"na\">items</span><span class=\"p\">:</span> <span class=\"p\">{</span> <span class=\"na\">oneOf</span><span class=\"p\">:</span> <span class=\"nx\">greetErrorSchemaPaths</span> <span class=\"p\">},</span>\n  <span class=\"p\">})</span>\n  <span class=\"k\">readonly</span> <span class=\"nx\">errors</span><span class=\"p\">:</span> <span class=\"nx\">GreetErrors</span><span class=\"p\">;</span>\n\n  <span class=\"kd\">constructor</span><span class=\"p\">(</span><span class=\"nx\">message</span><span class=\"p\">:</span> <span class=\"kr\">string</span> <span class=\"o\">|</span> <span class=\"kc\">null</span><span class=\"p\">,</span> <span class=\"nx\">errors</span><span class=\"p\">:</span> <span class=\"nx\">GreetErrors</span><span class=\"p\">)</span> <span class=\"p\">{</span>\n    <span class=\"k\">this</span><span class=\"p\">.</span><span class=\"nx\">message</span> <span class=\"o\">=</span> <span class=\"nx\">message</span><span class=\"p\">;</span>\n    <span class=\"k\">this</span><span class=\"p\">.</span><span class=\"nx\">errors</span> <span class=\"o\">=</span> <span class=\"nx\">errors</span><span class=\"p\">;</span>\n  <span class=\"p\">}</span>\n<span class=\"p\">}</span>\n</code></pre></div>\n</div>\n\n<p>ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã®ã‚µãƒ³ãƒ—ãƒ«ã§ã™<br>\n<code>@ApiOkResponse</code> ã«ã‚ˆã£ã¦ã‚¢ãƒãƒ†ãƒ¼ãƒˆã—ãŸDTOã‚’æŒ‡å®šã—ã¾ã™ã€‚ <code>@ApiOperation</code> ã§ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã«ç”Ÿæˆã•ã‚Œã‚‹ãƒ¡ã‚½ãƒƒãƒ‰åã‚’æŒ‡å®šã§ãã¾ã™</p>\n\n<div class=\"code-frame\" data-lang=\"typescript\">\n<div class=\"code-lang\"><span class=\"bold\">ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆï¼ˆãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ï¼‰</span></div>\n<div class=\"highlight\"><pre><code><span class=\"p\">@</span><span class=\"nd\">ApiTags</span><span class=\"p\">(</span><span class=\"dl\">'</span><span class=\"s1\">App</span><span class=\"dl\">'</span><span class=\"p\">)</span>\n<span class=\"p\">@</span><span class=\"nd\">Controller</span><span class=\"p\">()</span>\n<span class=\"k\">export</span> <span class=\"kd\">class</span> <span class=\"nx\">AppController</span> <span class=\"p\">{</span>\n  <span class=\"kd\">constructor</span><span class=\"p\">(</span><span class=\"k\">private</span> <span class=\"k\">readonly</span> <span class=\"nx\">appService</span><span class=\"p\">:</span> <span class=\"nx\">AppService</span><span class=\"p\">)</span> <span class=\"p\">{}</span>\n\n  <span class=\"p\">@</span><span class=\"nd\">ApiOkResponse</span><span class=\"p\">({</span> <span class=\"na\">type</span><span class=\"p\">:</span> <span class=\"nx\">GreetResponse</span> <span class=\"p\">})</span>\n  <span class=\"p\">@</span><span class=\"nd\">ApiOperation</span><span class=\"p\">({</span> <span class=\"na\">operationId</span><span class=\"p\">:</span> <span class=\"dl\">'</span><span class=\"s1\">greet</span><span class=\"dl\">'</span> <span class=\"p\">})</span>\n  <span class=\"p\">@</span><span class=\"nd\">Post</span><span class=\"p\">(</span><span class=\"dl\">'</span><span class=\"s1\">greet</span><span class=\"dl\">'</span><span class=\"p\">)</span>\n  <span class=\"p\">@</span><span class=\"nd\">HttpCode</span><span class=\"p\">(</span><span class=\"mi\">200</span><span class=\"p\">)</span>\n  <span class=\"nx\">greet</span><span class=\"p\">(@</span><span class=\"nd\">Body</span><span class=\"p\">()</span> <span class=\"nx\">request</span><span class=\"p\">:</span> <span class=\"nx\">GreetRequest</span><span class=\"p\">):</span> <span class=\"nx\">GreetResponse</span> <span class=\"p\">{</span>\n    <span class=\"c1\">// å…¥åŠ›ãƒã‚§ãƒƒã‚¯</span>\n    <span class=\"kd\">const</span> <span class=\"nx\">errors</span> <span class=\"o\">=</span> <span class=\"k\">this</span><span class=\"p\">.</span><span class=\"nx\">appService</span><span class=\"p\">.</span><span class=\"nx\">validateGreetRequest</span><span class=\"p\">(</span><span class=\"nx\">request</span><span class=\"p\">);</span>\n\n    <span class=\"kd\">let</span> <span class=\"nx\">message</span><span class=\"p\">:</span> <span class=\"kr\">string</span> <span class=\"o\">|</span> <span class=\"kc\">null</span> <span class=\"o\">=</span> <span class=\"kc\">null</span><span class=\"p\">;</span>\n    <span class=\"k\">if</span> <span class=\"p\">(</span><span class=\"nx\">errors</span><span class=\"p\">.</span><span class=\"nx\">length</span> <span class=\"o\">===</span> <span class=\"mi\">0</span><span class=\"p\">)</span> <span class=\"p\">{</span>\n      <span class=\"c1\">// ã‚¨ãƒ©ãƒ¼ãªã—ã®å ´åˆã®ã¿ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å–å¾—</span>\n      <span class=\"nx\">message</span> <span class=\"o\">=</span> <span class=\"k\">this</span><span class=\"p\">.</span><span class=\"nx\">appService</span><span class=\"p\">.</span><span class=\"nx\">getGreetingMessage</span><span class=\"p\">(</span><span class=\"nx\">request</span><span class=\"p\">);</span>\n    <span class=\"p\">}</span>\n\n    <span class=\"k\">return</span> <span class=\"k\">new</span> <span class=\"nx\">GreetResponse</span><span class=\"p\">(</span><span class=\"nx\">message</span><span class=\"p\">,</span> <span class=\"nx\">errors</span><span class=\"p\">);</span>\n  <span class=\"p\">}</span>\n<span class=\"p\">}</span>\n</code></pre></div>\n</div>\n\n<p>NestJSã®ã‚³ãƒ¼ãƒ‰ã‹ã‚‰yamlãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç”Ÿæˆã™ã‚‹æ–¹æ³•ã¯<a href=\"https://qiita.com/yktakaha4/items/97ea169ed97dbcdd25fb\" id=\"reference-2e250818221dc4026861\">ã“ã¡ã‚‰</a> ã§ã‚‚èª¬æ˜ã—ã¦ã„ã¾ã™<br>\nã‚³ãƒãƒ³ãƒ‰ã¯ä»¥ä¸‹</p>\n\n<div class=\"code-frame\" data-lang=\"terminal\"><div class=\"highlight\"><pre><code><span class=\"gp\">$</span><span class=\"w\"> </span><span class=\"nb\">cd</span> ./backend\n<span class=\"gp\">$</span><span class=\"w\"> </span>npm run openapi:export\n</code></pre></div></div>\n\n<h2>\n<span id=\"yamlãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆç”Ÿæˆ\" class=\"fragment\"></span><a href=\"#yaml%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%81%8B%E3%82%89%E3%82%AF%E3%83%A9%E3%82%A4%E3%82%A2%E3%83%B3%E3%83%88%E7%94%9F%E6%88%90\"><i class=\"fa fa-link\"></i></a>yamlãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆç”Ÿæˆ</h2>\n\n<p>ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã®ã‚³ãƒ¼ãƒ‰ã¨ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’åˆ†ã‘ã‚‹ãŸã‚ã€ <code>./backend/client</code> é…ä¸‹ã«npmãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ç”¨ã®ä¸€å¼ã‚’æ ¼ç´ã—ã¦ã„ã¾ã™</p>\n\n<div class=\"code-frame\" data-lang=\"terminal\"><div class=\"highlight\"><pre><code><span class=\"gp\">$</span><span class=\"w\"> </span><span class=\"nb\">cd</span> ./backend/client\n<span class=\"gp\">$</span><span class=\"w\"> </span>npm ci\n<span class=\"gp\">$</span><span class=\"w\"> </span>npm run generate\n<span class=\"gp\">$</span><span class=\"w\"> </span>npm run build\n<span class=\"go\">\n</span><span class=\"gp\">#</span><span class=\"w\"> </span>run generateæ™‚ã«å®Ÿè¡Œã•ã‚Œã‚‹ã‚³ãƒãƒ³ãƒ‰\n<span class=\"gp\">#</span><span class=\"w\"> </span>ã‚ªãƒ—ã‚·ãƒ§ãƒ³ç­‰ã¯ä»¥ä¸‹å‚ç…§\n<span class=\"gp\">#</span><span class=\"w\"> </span>https://github.com/OpenAPITools/openapi-generator/blob/master/docs/generators/typescript-axios.md\n<span class=\"gp\">#</span><span class=\"w\"> </span><span class=\"nv\">JAVA_OPTS</span><span class=\"o\">=</span><span class=\"s2\">\"-Dlog.level=warn\"</span> openapi-generator generate <span class=\"nt\">-i</span> sample-backend.yml <span class=\"nt\">-o</span> lib/ <span class=\"nt\">-g</span> typescript-axios <span class=\"nt\">--api-package</span><span class=\"o\">=</span>api <span class=\"nt\">--model-package</span><span class=\"o\">=</span>models <span class=\"nt\">--additional-properties</span><span class=\"o\">=</span><span class=\"nv\">supportsES6</span><span class=\"o\">=</span><span class=\"nb\">true</span>,withSeparateModelsAndApi<span class=\"o\">=</span><span class=\"nb\">true</span>\n</code></pre></div></div>\n\n<h2>\n<span id=\"npmãƒ‘ãƒƒã‚±ãƒ¼ã‚¸å…¬é–‹\" class=\"fragment\"></span><a href=\"#npm%E3%83%91%E3%83%83%E3%82%B1%E3%83%BC%E3%82%B8%E5%85%AC%E9%96%8B\"><i class=\"fa fa-link\"></i></a>npmãƒ‘ãƒƒã‚±ãƒ¼ã‚¸å…¬é–‹</h2>\n\n<p>GitHub Actionsã«ã¦ã€ <code>client.*</code> ã¨ã„ã†å½¢å¼ã®ã‚¿ã‚°ãŒæ‰“ãŸã‚ŒãŸã‚‰ä»¥ä¸‹ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã‚’å®Ÿè¡Œã™ã‚‹ã‚ˆã†ã«ã—ã¾ã™<br>\nnpm publishæ™‚ã«ã€ç”Ÿæˆã—ãŸãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³åã‚’ä¸€æ„ã«ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã®ã§ã€ä»Šå›ã¯<a href=\"https://github.com/yktakaha4/nestjs-typed-client/blob/master/backend/client/set-package-version.js\" rel=\"nofollow noopener\" target=\"_blank\">ã“ã¡ã‚‰</a>ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ä½¿ã£ã¦å®Ÿç¾ã—ã¦ã„ã¾ã™<br>\nä»Šå›ã¯ã€ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå´ã§èª­ã¿è¾¼ã‚“ã§ã„ã‚‹ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®ä¸€æ„æ€§ã‚’ä¿è¨¼ã§ãã‚Œã°ååˆ†ã ã£ãŸã®ã§ã€ã‚»ãƒãƒ³ãƒ†ã‚£ãƒƒã‚¯ãƒãƒ¼ã‚¸ãƒ§ãƒ‹ãƒ³ã‚°ã¯è€ƒæ…®ã›ãšã«ã€ <code>0.0.1-${ã‚¿ã‚°å}</code> ã®å½¢å¼ã§å…¬é–‹ã™ã‚‹ã‚ˆã†ã«ã—ã¾ã—ãŸ</p>\n\n<p>ã¡ãªã¿ã«ã€ãƒˆãƒ¼ã‚¯ãƒ³ã«ã¤ã„ã¦ã¯ã€GitHub ActionsãŒãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§æŒ‡å®šã—ã¦ãã‚Œã‚‹ã‚‚ã®ã§å•é¡Œã‚ã‚Šã¾ã›ã‚“<br>\nï¼ˆãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆãƒªãƒã‚¸ãƒˆãƒªã®å ´åˆã€ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®èª­ã¿è¾¼ã¿ã‚’è¡Œã†å´ã§ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®èª­ã¿è¾¼ã¿æ¨©é™ã®ã‚ã‚‹ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ã®ç™ºè¡ŒãŒå¿…è¦ã«ãªã‚Šã¾ã™ï¼‰</p>\n\n<div class=\"code-frame\" data-lang=\"yaml\">\n<div class=\"code-lang\"><span class=\"bold\">publish-client.yml</span></div>\n<div class=\"highlight\"><pre><code><span class=\"na\">name</span><span class=\"pi\">:</span> <span class=\"s\">Publish client</span>\n\n<span class=\"na\">on</span><span class=\"pi\">:</span>\n  <span class=\"na\">push</span><span class=\"pi\">:</span>\n    <span class=\"na\">tags</span><span class=\"pi\">:</span>\n      <span class=\"pi\">-</span> <span class=\"s\">client.*</span>\n\n<span class=\"na\">jobs</span><span class=\"pi\">:</span>\n  <span class=\"na\">publish</span><span class=\"pi\">:</span>\n    <span class=\"na\">name</span><span class=\"pi\">:</span> <span class=\"s\">Publish client</span>\n    <span class=\"na\">runs-on</span><span class=\"pi\">:</span> <span class=\"s\">ubuntu-18.04</span>\n    <span class=\"na\">timeout-minutes</span><span class=\"pi\">:</span> <span class=\"m\">3</span>\n    <span class=\"na\">steps</span><span class=\"pi\">:</span>\n      <span class=\"pi\">-</span> <span class=\"na\">uses</span><span class=\"pi\">:</span> <span class=\"s\">actions/checkout@v2</span>\n\n      <span class=\"pi\">-</span> <span class=\"na\">uses</span><span class=\"pi\">:</span> <span class=\"s\">actions/setup-node@v1</span>\n        <span class=\"na\">with</span><span class=\"pi\">:</span>\n          <span class=\"na\">node-version</span><span class=\"pi\">:</span> <span class=\"s\">12.x</span>\n          <span class=\"na\">registry-url</span><span class=\"pi\">:</span> <span class=\"s\">https://npm.pkg.github.com/</span>\n          <span class=\"na\">scope</span><span class=\"pi\">:</span> <span class=\"s2\">\"</span><span class=\"s\">@yktakaha4\"</span>\n\n      <span class=\"pi\">-</span> <span class=\"na\">run</span><span class=\"pi\">:</span> <span class=\"s\">npm ci</span>\n        <span class=\"na\">working-directory</span><span class=\"pi\">:</span> <span class=\"s\">./backend</span>\n\n      <span class=\"pi\">-</span> <span class=\"na\">run</span><span class=\"pi\">:</span> <span class=\"s\">npm run openapi:export</span>\n        <span class=\"na\">working-directory</span><span class=\"pi\">:</span> <span class=\"s\">./backend</span>\n\n      <span class=\"pi\">-</span> <span class=\"na\">run</span><span class=\"pi\">:</span> <span class=\"s\">npm ci</span>\n        <span class=\"na\">working-directory</span><span class=\"pi\">:</span> <span class=\"s\">./backend/client</span>\n\n      <span class=\"pi\">-</span> <span class=\"na\">run</span><span class=\"pi\">:</span> <span class=\"s\">npm run version $GH_REF</span>\n        <span class=\"na\">working-directory</span><span class=\"pi\">:</span> <span class=\"s\">./backend/client</span>\n        <span class=\"na\">env</span><span class=\"pi\">:</span>\n          <span class=\"na\">GH_REF</span><span class=\"pi\">:</span> <span class=\"s\">${{ github.ref }}</span>\n\n      <span class=\"pi\">-</span> <span class=\"na\">run</span><span class=\"pi\">:</span> <span class=\"s\">npm publish</span>\n        <span class=\"na\">working-directory</span><span class=\"pi\">:</span> <span class=\"s\">./backend/client</span>\n        <span class=\"na\">env</span><span class=\"pi\">:</span>\n          <span class=\"na\">NODE_AUTH_TOKEN</span><span class=\"pi\">:</span> <span class=\"s\">${{ secrets.GITHUB_TOKEN }}</span>\n</code></pre></div>\n</div>\n\n<p>ä¸Šè¨˜ã«åŸºã¥ã„ã¦ç”Ÿæˆã•ã‚ŒãŸnpmãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã¯ã€<a href=\"https://github.com/yktakaha4/nestjs-typed-client/packages/\" rel=\"nofollow noopener\" target=\"_blank\">ã“ã¡ã‚‰</a> ã«ã¦å…¬é–‹ã•ã‚Œã¾ã™</p>\n\n<h1>\n<span id=\"demo\" class=\"fragment\"></span><a href=\"#demo\"><i class=\"fa fa-link\"></i></a>Demo</h1>\n\n<p>ä»¥ä¸‹ã®æ–¹æ³•ã§èµ·å‹•ã§ãã¾ã™<br>\nãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã¯ <code>localhost:3100</code>ã€ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã¯ <code>localhost:3000</code> ã§èµ·å‹•ã—ã¾ã™</p>\n\n<div class=\"code-frame\" data-lang=\"terminal\">\n<div class=\"code-lang\"><span class=\"bold\">ã‚¿ãƒ¼ãƒŸãƒŠãƒ«</span></div>\n<div class=\"highlight\"><pre><code><span class=\"gp\">#</span><span class=\"w\"> </span>ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã‚’èµ·å‹•\n<span class=\"gp\">$</span><span class=\"w\"> </span><span class=\"nb\">cd</span> ./backend\n<span class=\"gp\">$</span><span class=\"w\"> </span>npm ci\n<span class=\"gp\">$</span><span class=\"w\"> </span>npm run start\n<span class=\"go\">\n</span><span class=\"gp\">#</span><span class=\"w\"> </span>ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã‚’èµ·å‹•ï¼ˆåˆ¥ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã«ã¦ï¼‰\n<span class=\"gp\">$</span><span class=\"w\"> </span><span class=\"nb\">cd</span> ./frontend\n<span class=\"gp\">$</span><span class=\"w\"> </span>yarn <span class=\"nb\">install</span>\n<span class=\"gp\">$</span><span class=\"w\"> </span>yarn start\n</code></pre></div>\n</div>\n\n<p>ãƒ†ã‚­ã‚¹ãƒˆãƒœãƒƒã‚¯ã‚¹ã«è‹—å­—ã€åå‰ã‚’å…¥åŠ›ã—ã¦ <code>Greet</code> ãƒœã‚¿ãƒ³ã‚’æŠ¼ã™ã¨ã€æŒ¨æ‹¶ãŒè¿”å´ã•ã‚Œã¾ã™ğŸ‘‹</p>\n\n<p><a href=\"https://camo.qiitausercontent.com/25ce45631d4a231314337468e9284491df99d831/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3130363235392f30333866313130352d386137352d656435622d613962302d3830626539376462333438322e706e67\" target=\"_blank\" rel=\"nofollow noopener\"><img src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F106259%2F038f1105-8a75-ed5b-a9b0-80be97db3482.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=92ba519d5a883f07c7d3c8bb36e04233\" alt=\"åå‰ã‚’å…¥åŠ›\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/106259/038f1105-8a75-ed5b-a9b0-80be97db3482.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F106259%2F038f1105-8a75-ed5b-a9b0-80be97db3482.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=160b622754d616fa77b11a901ebaac13 1x\" loading=\"lazy\"></a></p>\n\n<p>ãƒªã‚¯ã‚¨ã‚¹ãƒˆã¨ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã¯ãã‚Œãã‚Œã“ã‚“ãªæ„Ÿã˜ã®ã‚‚ã®ãŒé€å—ã•ã‚Œã¾ã™</p>\n\n<div class=\"code-frame\" data-lang=\"json\">\n<div class=\"code-lang\"><span class=\"bold\">Request</span></div>\n<div class=\"highlight\"><pre><code><span class=\"p\">{</span><span class=\"w\">\n  </span><span class=\"nl\">\"lastName\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"yuuki\"</span><span class=\"p\">,</span><span class=\"w\">\n  </span><span class=\"nl\">\"firstName\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"takahashi\"</span><span class=\"w\">\n</span><span class=\"p\">}</span><span class=\"w\">\n</span></code></pre></div>\n</div>\n\n<div class=\"code-frame\" data-lang=\"json\">\n<div class=\"code-lang\"><span class=\"bold\">Response</span></div>\n<div class=\"highlight\"><pre><code><span class=\"p\">{</span><span class=\"w\">\n  </span><span class=\"nl\">\"message\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"Hello, Yuuki TAKAHASHI !\"</span><span class=\"p\">,</span><span class=\"w\">\n  </span><span class=\"nl\">\"errors\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"p\">[]</span><span class=\"w\">\n</span><span class=\"p\">}</span><span class=\"w\">\n</span></code></pre></div>\n</div>\n\n<p>ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã‹ã‚‰ã®APIå‘¼ã³å‡ºã—ã¯ã“ã‚“ãªæ„Ÿã˜ã«ãªã‚Šã¾ã™</p>\n\n<div class=\"code-frame\" data-lang=\"typescript\">\n<div class=\"code-lang\"><span class=\"bold\">å‘¼ã³å‡ºã—ã‚µãƒ³ãƒ—ãƒ«ï¼ˆãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ï¼‰</span></div>\n<div class=\"highlight\"><pre><code><span class=\"c1\">// AppApiã‚¯ãƒ©ã‚¹ã¯ npmãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‹ã‚‰ã‚¤ãƒ³ãƒãƒ¼ãƒˆã—ãŸã‚‚ã®ï¼ˆè‡ªå‹•ç”Ÿæˆï¼‰</span>\n<span class=\"kd\">const</span> <span class=\"nx\">api</span> <span class=\"o\">=</span> <span class=\"k\">new</span> <span class=\"nx\">AppApi</span><span class=\"p\">();</span>\n\n<span class=\"nx\">api</span><span class=\"p\">.</span><span class=\"nx\">greet</span><span class=\"p\">(</span><span class=\"nx\">greetingRequest</span><span class=\"p\">).</span><span class=\"nx\">then</span><span class=\"p\">((</span><span class=\"nx\">axiosResponse</span><span class=\"p\">)</span> <span class=\"o\">=&gt;</span> <span class=\"p\">{</span>\n  <span class=\"nx\">dispatchResponse</span><span class=\"p\">(</span><span class=\"nx\">axiosResponse</span><span class=\"p\">.</span><span class=\"nx\">data</span><span class=\"p\">);</span>\n<span class=\"p\">}).</span><span class=\"k\">catch</span><span class=\"p\">((</span><span class=\"nx\">error</span><span class=\"p\">)</span> <span class=\"o\">=&gt;</span> <span class=\"p\">{</span>\n  <span class=\"nx\">dispatch</span><span class=\"p\">({</span> <span class=\"na\">type</span><span class=\"p\">:</span> <span class=\"dl\">'</span><span class=\"s1\">UPDATE_MESSAGE</span><span class=\"dl\">'</span><span class=\"p\">,</span> <span class=\"na\">value</span><span class=\"p\">:</span> <span class=\"nb\">String</span><span class=\"p\">(</span><span class=\"nx\">error</span><span class=\"p\">)</span> <span class=\"p\">});</span>\n<span class=\"p\">});</span>\n</code></pre></div>\n</div>\n\n<p>ã‚¤ãƒ³ãƒ†ãƒªã‚»ãƒ³ã‚¹ãŒã¡ã‚ƒã‚“ã¨åŠ¹ã„ã¦ã¾ã™</p>\n\n<p><a href=\"https://camo.qiitausercontent.com/0a7ffbd907f3a954d78c8472e86eaa8cf08c51b4/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3130363235392f33373936313532332d623965332d666334362d336230652d3761393666626262656566612e706e67\" target=\"_blank\" rel=\"nofollow noopener\"><img src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F106259%2F37961523-b9e3-fc46-3b0e-7a96fbbbeefa.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=3eb3c344dd9a1aa6215a211754bcc60f\" alt=\"ã‚¤ãƒ³ãƒ†ãƒªã‚»ãƒ³ã‚¹\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/106259/37961523-b9e3-fc46-3b0e-7a96fbbbeefa.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F106259%2F37961523-b9e3-fc46-3b0e-7a96fbbbeefa.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=52b16a31ec534d6cad58c1279483fb55 1x\" loading=\"lazy\"></a></p>\n\n<p>å…¥åŠ›ã‚¨ãƒ©ãƒ¼ï¼ˆå€¤ãŒç©º or ä¸‹å“ãªè¨€è‘‰ãŒå…¥åŠ›ã•ã‚Œã¦ã„ã‚‹ï¼‰ã‚’ã‚µãƒ¼ãƒã‚µã‚¤ãƒ‰ã§æ¤œè¨¼ã—ã€ã‚¨ãƒ©ãƒ¼ã®å ´åˆã¯ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã«ã¦ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ç·¨é›†ã—ã¾ã™</p>\n\n<p><a href=\"https://camo.qiitausercontent.com/ada15f54c975345b758ec520b421b0a3e09c5c64/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3130363235392f62356361356334392d333261312d383238332d393061362d3838306232666363623663312e706e67\" target=\"_blank\" rel=\"nofollow noopener\"><img src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F106259%2Fb5ca5c49-32a1-8283-90a6-880b2fccb6c1.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=7b598a2840db236d0bf05128d0f64042\" alt=\"å…¥åŠ›ã‚¨ãƒ©ãƒ¼\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/106259/b5ca5c49-32a1-8283-90a6-880b2fccb6c1.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F106259%2Fb5ca5c49-32a1-8283-90a6-880b2fccb6c1.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=3f650f68a67cca8473e75ecb1fc2cdd8 1x\" loading=\"lazy\"></a></p>\n\n<div class=\"code-frame\" data-lang=\"json\">\n<div class=\"code-lang\"><span class=\"bold\">Response</span></div>\n<div class=\"highlight\"><pre><code><span class=\"p\">{</span><span class=\"w\">\n  </span><span class=\"nl\">\"message\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"kc\">null</span><span class=\"p\">,</span><span class=\"w\">\n  </span><span class=\"nl\">\"errors\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"p\">[</span><span class=\"w\">\n    </span><span class=\"p\">{</span><span class=\"w\">\n      </span><span class=\"nl\">\"type\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"EmptyNameError\"</span><span class=\"p\">,</span><span class=\"w\">\n      </span><span class=\"nl\">\"parameter\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"LastName\"</span><span class=\"w\">\n    </span><span class=\"p\">},</span><span class=\"w\">\n    </span><span class=\"p\">{</span><span class=\"w\">\n      </span><span class=\"nl\">\"type\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"VulgarNameError\"</span><span class=\"p\">,</span><span class=\"w\">\n      </span><span class=\"nl\">\"parameter\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"FirstName\"</span><span class=\"p\">,</span><span class=\"w\">\n      </span><span class=\"nl\">\"vulgarWord\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"shit\"</span><span class=\"w\">\n    </span><span class=\"p\">}</span><span class=\"w\">\n  </span><span class=\"p\">]</span><span class=\"w\">\n</span><span class=\"p\">}</span><span class=\"w\">\n</span></code></pre></div>\n</div>\n\n<p>ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ç·¨é›†ã®ã‚µãƒ³ãƒ—ãƒ«ã¯ä»¥ä¸‹ã«ãªã‚Šã¾ã™<br>\nã“ã®ã‚³ãƒ¼ãƒ‰ã ã‘ã§ã¯ã‚ã‹ã‚Šã¥ã‚‰ã„ã§ã™ãŒã€ <code>type</code> ã‚‚ <code>parameter</code> ã‚‚å‹ä»˜ã‘ã•ã‚Œã¦ãŠã‚Šã€ã¾ãŸ <a href=\"https://typescript-jp.gitbook.io/deep-dive/type-system/typeguard\" rel=\"nofollow noopener\" target=\"_blank\">å‹ã‚¬ãƒ¼ãƒ‰</a> ã®åŠ¹æœã«ã‚ˆã‚Š <code>VulgarNameError</code> ã®åˆ¤å®šæ–‡ã®ä¸­ã§ã¯ <code>vulgarWord</code> ãŒå‚ç…§ã§ãã¦ã„ã¾ã™ğŸŒ¿</p>\n\n<div class=\"code-frame\" data-lang=\"typescript\">\n<div class=\"code-lang\"><span class=\"bold\">ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸è¨­å®šã‚µãƒ³ãƒ—ãƒ«ï¼ˆãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ï¼‰</span></div>\n<div class=\"highlight\"><pre><code><span class=\"kd\">const</span> <span class=\"nx\">dispatchResponse</span> <span class=\"o\">=</span> <span class=\"p\">(</span><span class=\"nx\">response</span><span class=\"p\">:</span> <span class=\"nx\">GreetResponse</span><span class=\"p\">)</span> <span class=\"o\">=&gt;</span> <span class=\"p\">{</span>\n  <span class=\"k\">if</span> <span class=\"p\">(</span><span class=\"nx\">response</span><span class=\"p\">.</span><span class=\"nx\">message</span><span class=\"p\">)</span> <span class=\"p\">{</span>\n    <span class=\"c1\">// ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè¿”å´ã•ã‚ŒãŸå ´åˆã¯ãã‚Œã‚’è¨­å®š</span>\n    <span class=\"nx\">dispatch</span><span class=\"p\">({</span> <span class=\"na\">type</span><span class=\"p\">:</span> <span class=\"dl\">'</span><span class=\"s1\">UPDATE_MESSAGE</span><span class=\"dl\">'</span><span class=\"p\">,</span> <span class=\"na\">value</span><span class=\"p\">:</span> <span class=\"nx\">response</span><span class=\"p\">.</span><span class=\"nx\">message</span> <span class=\"p\">});</span>\n  <span class=\"p\">}</span> <span class=\"k\">else</span> <span class=\"p\">{</span>\n    <span class=\"c1\">// ã•ã‚Œãªã‹ã£ãŸå ´åˆã¯ã€ã‚¨ãƒ©ãƒ¼ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«åˆã‚ã›ã¦è¨­å®š</span>\n    <span class=\"kd\">const</span> <span class=\"na\">messages</span><span class=\"p\">:</span> <span class=\"nb\">Array</span><span class=\"o\">&lt;</span><span class=\"kr\">string</span><span class=\"o\">&gt;</span> <span class=\"o\">=</span> <span class=\"p\">[];</span>\n    <span class=\"k\">for</span> <span class=\"p\">(</span><span class=\"kd\">const</span> <span class=\"nx\">error</span> <span class=\"k\">of</span> <span class=\"nx\">response</span><span class=\"p\">.</span><span class=\"nx\">errors</span><span class=\"p\">)</span> <span class=\"p\">{</span>\n      <span class=\"k\">if</span> <span class=\"p\">(</span><span class=\"nx\">error</span><span class=\"p\">.</span><span class=\"kd\">type</span> <span class=\"o\">===</span> <span class=\"dl\">'</span><span class=\"s1\">EmptyNameError</span><span class=\"dl\">'</span><span class=\"p\">)</span> <span class=\"p\">{</span>\n        <span class=\"k\">if</span> <span class=\"p\">(</span><span class=\"nx\">error</span><span class=\"p\">.</span><span class=\"nx\">parameter</span> <span class=\"o\">===</span> <span class=\"dl\">'</span><span class=\"s1\">LastName</span><span class=\"dl\">'</span><span class=\"p\">)</span> <span class=\"p\">{</span>\n          <span class=\"nx\">messages</span><span class=\"p\">.</span><span class=\"nx\">push</span><span class=\"p\">(</span><span class=\"dl\">'</span><span class=\"s1\">ãƒ»åå‰ã¯ç©ºã«ã§ãã¾ã›ã‚“</span><span class=\"dl\">'</span><span class=\"p\">);</span>\n        <span class=\"p\">}</span> <span class=\"k\">else</span> <span class=\"k\">if</span> <span class=\"p\">(</span><span class=\"nx\">error</span><span class=\"p\">.</span><span class=\"nx\">parameter</span> <span class=\"o\">===</span> <span class=\"dl\">'</span><span class=\"s1\">FirstName</span><span class=\"dl\">'</span><span class=\"p\">)</span> <span class=\"p\">{</span>\n          <span class=\"nx\">messages</span><span class=\"p\">.</span><span class=\"nx\">push</span><span class=\"p\">(</span><span class=\"dl\">'</span><span class=\"s1\">ãƒ»è‹—å­—ã¯ç©ºã«ã§ãã¾ã›ã‚“</span><span class=\"dl\">'</span><span class=\"p\">);</span>\n        <span class=\"p\">}</span>\n      <span class=\"p\">}</span> <span class=\"k\">else</span> <span class=\"k\">if</span> <span class=\"p\">(</span><span class=\"nx\">error</span><span class=\"p\">.</span><span class=\"kd\">type</span> <span class=\"o\">===</span> <span class=\"dl\">'</span><span class=\"s1\">VulgarNameError</span><span class=\"dl\">'</span><span class=\"p\">)</span> <span class=\"p\">{</span>\n        <span class=\"k\">if</span> <span class=\"p\">(</span><span class=\"nx\">error</span><span class=\"p\">.</span><span class=\"nx\">parameter</span> <span class=\"o\">===</span> <span class=\"dl\">'</span><span class=\"s1\">LastName</span><span class=\"dl\">'</span><span class=\"p\">)</span> <span class=\"p\">{</span>\n          <span class=\"nx\">messages</span><span class=\"p\">.</span><span class=\"nx\">push</span><span class=\"p\">(</span><span class=\"s2\">`ãƒ»åå‰ã« </span><span class=\"p\">${</span><span class=\"nx\">error</span><span class=\"p\">.</span><span class=\"nx\">vulgarWord</span><span class=\"p\">}</span><span class=\"s2\"> ã¯è¨­å®šã§ãã¾ã›ã‚“`</span><span class=\"p\">);</span>\n        <span class=\"p\">}</span> <span class=\"k\">else</span> <span class=\"k\">if</span> <span class=\"p\">(</span><span class=\"nx\">error</span><span class=\"p\">.</span><span class=\"nx\">parameter</span> <span class=\"o\">===</span> <span class=\"dl\">'</span><span class=\"s1\">FirstName</span><span class=\"dl\">'</span><span class=\"p\">)</span> <span class=\"p\">{</span>\n          <span class=\"nx\">messages</span><span class=\"p\">.</span><span class=\"nx\">push</span><span class=\"p\">(</span><span class=\"s2\">`ãƒ»è‹—å­—ã« </span><span class=\"p\">${</span><span class=\"nx\">error</span><span class=\"p\">.</span><span class=\"nx\">vulgarWord</span><span class=\"p\">}</span><span class=\"s2\"> ã¯è¨­å®šã§ãã¾ã›ã‚“`</span><span class=\"p\">);</span>\n        <span class=\"p\">}</span>\n      <span class=\"p\">}</span>\n    <span class=\"p\">}</span>\n\n    <span class=\"nx\">dispatch</span><span class=\"p\">({</span> <span class=\"na\">type</span><span class=\"p\">:</span> <span class=\"dl\">'</span><span class=\"s1\">UPDATE_MESSAGE</span><span class=\"dl\">'</span><span class=\"p\">,</span> <span class=\"na\">value</span><span class=\"p\">:</span> <span class=\"nx\">messages</span><span class=\"p\">.</span><span class=\"nx\">join</span><span class=\"p\">(</span><span class=\"dl\">''</span><span class=\"p\">)</span> <span class=\"p\">});</span>\n  <span class=\"p\">}</span>\n<span class=\"p\">};</span>\n</code></pre></div>\n</div>\n\n<p>ä¸€ã¤æ®‹å¿µãªã®ã¯ã€ç¾æ™‚ç‚¹ã§ã®OpenAPIv3ã§ã¯ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ä¸Šã§ãƒªãƒ†ãƒ©ãƒ«å€¤ã‚’è¡¨ç¾ã§ããªã„ãŸã‚ã€ï¼ˆ<a href=\"https://swagger.io/docs/specification/describing-parameters/\" rel=\"nofollow noopener\" target=\"_blank\">ã“ã¡ã‚‰ã®Constant Parametersã®é …ã®ã‚ˆã†ã«ã€å˜ä¸€ã®ãƒ¡ãƒ³ãƒã‚’æŒã¤Enumã¨ã—ã¦å®šç¾©ã™ã‚‹å¿…è¦ã‚ã‚Š</a>ï¼‰<br>\nä¸Šè¨˜ã®å‹ã‚¬ãƒ¼ãƒ‰ã‚’å®Ÿç¾ã™ã‚‹ã«ã‚ãŸã‚Šã€ <code>type</code> ã‚’ <code>'EmptyNameError' | 'VulgarNameError'</code> ã®ã‚ˆã†ãªstringã®Unionå‹ã§ã¯å®šç¾©ã§ããšã€è‡ªå‹•ç”Ÿæˆã•ã‚Œã‚‹ã‚³ãƒ¼ãƒ‰ã¯ <code>EmptyNameErrorTypeEnum | VulgarNameErrorTypeEnum</code> ã®ã‚ˆã†ãªå½¢ã«ãªã‚‹ãŸã‚ã€ã‚¤ãƒ³ãƒ†ãƒªã‚»ãƒ³ã‚¹ã‚’åŠ¹ã‹ã›ã‚‹ã“ã¨ãŒã§ããšã«ã„ã¾ã™<br>\nå€¤ã®æ¤œè¨¼ã¯æ­£ã—ãã§ãã‚‹ãŸã‚ã€ã“ã‚Œã§ã‚‚å•é¡Œã¯ãªã„ã§ã™ãŒ...<br>\nï¼ˆç§ã®ç†è§£ä¸è¶³ãªã ã‘ã§ã€ã„ã„ã‚„ã‚Šæ–¹ãŒã§ãã‚‹æ°—ã¯ã‚‚ã®ã™ã”ãã—ã¾ã™ğŸ™ƒï¼‰</p>\n\n<p>ã‚ã¨ã€ä»Šå›ã¯æœ¬æ—¨ã‹ã‚‰å¤–ã‚Œã‚‹ãŸã‚å‰²æ„›ã—ã¦ã„ã¾ã™ãŒã€é …ç›®æ¯ã®ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã«ã¤ã„ã¦ã¯<a href=\"https://docs.nestjs.com/techniques/validation#validation\" rel=\"nofollow noopener\" target=\"_blank\">ã“ã¡ã‚‰</a>ã‚’ä½¿ã†ã¨ã„ã„æ„Ÿã˜ã«ã§ãã‚‹ã®ã§ã€ä½µã›ã¦å°å…¥ã‚’ã‚ªã‚¹ã‚¹ãƒ¡ã—ã¾ã™</p>\n\n<h1>\n<span id=\"ã¾ã¨ã‚\" class=\"fragment\"></span><a href=\"#%E3%81%BE%E3%81%A8%E3%82%81\"><i class=\"fa fa-link\"></i></a>ã¾ã¨ã‚</h1>\n\n<p>ã²ã¨ã¤ã„ã„å®Ÿè£…ãƒ‘ã‚¿ãƒ¼ãƒ³ãŒä½œã‚ŒãŸæ°—ãŒã™ã‚‹ã®ã§ã€ä»–ã®ã‚„ã‚Šæ–¹ï¼ˆå…ˆã»ã©èª¬æ˜ã—ãŸGraphQLã‚„ã€<a href=\"https://github.com/frouriojs/frourio\" rel=\"nofollow noopener\" target=\"_blank\">frourio</a>ãªã‚“ã‹ã‚‚ãã†ãªã‚“ã§ã—ã‚‡ã†ã‹ï¼Ÿï¼‰ã«ã¤ã„ã¦ã‚‚æŒ‘æˆ¦ã—ã¦ã„ããŸã„ã¨æ€ã„ã¾ã™ï¼</p>\n",
    "body": "ã“ã¡ã‚‰ã¯ã€[TypeScript Advent Calendar 2020](https://qiita.com/advent-calendar/2020/typescript) 14æ—¥ç›®ã®è¨˜äº‹ã«ãªã‚Šã¾ã™ï¼\n\n# ã¯ã˜ã‚ã«\n\næœ€è¿‘ã€å€‹äººã§ã®é–‹ç™ºã«ã¦TypeScriptã‚’é¸å®šã™ã‚‹ã“ã¨ãŒå¤šããªã‚Šã€ãã®ä¸­ã§ [NestJS](https://nestjs.com/) ã‚’ä½¿ã£ã¦ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã®APIã‚’æ§‹ç¯‰ã™ã‚‹æ©Ÿä¼šãŒã‚ã£ãŸã®ã§ã™ãŒã€\nãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ï¼ˆ[Nuxt.js](https://ja.nuxtjs.org/)ã§ä½œã£ãŸSPAï¼‰ã¨ã®é€šä¿¡ã«ã¤ã„ã¦ã€å‰²ã¨ã„ã„æ„Ÿã˜ã«ä½œã‚ŒãŸæ°—ãŒã—ãŸã®ã§ã€å‚™å¿˜éŒ²ã¨ã—ã¦æ®‹ã—ãŸã„ã¨æ€ã„ã¾ã™âœï¸\n\n# ã©ã‚“ãªã‚‚ã®ã‚’ä½œã‚‹ã‹\n\nWebã‚¢ãƒ—ãƒªã®ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã¨ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰é–“ã§ã®é€šä¿¡ã¨ã—ã¦ã€ä»¥ä¸‹ã®ã“ã¨ã‚’å®Ÿç¾ã—ãŸã„ã¨ã„ã†æ°—æŒã¡ãŒã‚ã‚Šã¾ã—ãŸ\n\n- `ãƒªã‚¯ã‚¨ã‚¹ãƒˆ/ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã«å‹ä»˜ã‘` ã—ãŸã„ğŸ’ª\n    - ãƒ•ãƒ­ãƒ³ãƒˆ/ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰åŒæ–¹ã®TSã§ã€Interfaceãªã‚ŠClassãªã‚Šã«å€¤ãŒè©°ã‚ã‚‰ã‚ŒãŸDTOã‚’æ‰±ã„ãŸã„\n    - ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰å´ã§å®šç¾©ã—ãŸå‹ã‚’ãƒ•ãƒ­ãƒ³ãƒˆå´ã§ã‚‚ä½¿ã„ãŸã„\n        - I/Fã®æ›´æ–°ã‚’ãƒ•ãƒ­ãƒ³ãƒˆå´ã‹ã‚‰ã„ã„æ„Ÿã˜ã«å–ã‚Šè¾¼ã¿ãŸã„\n- ãƒ•ãƒ­ãƒ³ãƒˆã®ã‚³ãƒ¼ãƒ‰ä¸Šã§`APIã§ã‚ã‚‹ã“ã¨ã‚’æ„è­˜ã—ãŸããªã„` ğŸª¨\n    - ãƒ‘ã‚¹ã¨ã‹HTTPãƒ¡ã‚½ãƒƒãƒ‰ã¨ã‹ã¯éš è”½ã—ã¦ã€TSä¸Šã§ã¯é–¢æ•°å‘¼ã³å‡ºã—ã§ä½¿ã„ãŸã„\n    - ãŸã ã—ã€Cookieã«ã‚ˆã‚‹ã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç†ã‚„ç’°å¢ƒæ¯ã«ãƒªã‚¯ã‚¨ã‚¹ãƒˆå…ˆã®ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚’åˆ†ã‘ã‚‹ãªã©ã€å¿…è¦ãŒã‚ã‚Œã°HTTPä¸Šã®æŒ™å‹•ã‚’ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã—ãŸã„\n- `ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚„æ¥­å‹™ã‚¨ãƒ©ãƒ¼ã‚’è¿”å´` ã—ãŸã„ğŸŸ\n    - é …ç›®æ¯ã®ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ã—ãŸã„\n        - ãƒ•ãƒ­ãƒ³ãƒˆã§ã‚‚ã‚ˆã—ãªã«ã‚„ã‚‹ãŒã€ç‰¹ã«ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰å´ã§æœŸå¾…ã—ãªã„ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’å—ã‘ãŸã‚‰ã‚¨ãƒ©ãƒ¼ã¨ã—ãŸã„\n    - æ¥­å‹™ã‚¨ãƒ©ãƒ¼ã‚’ã„ã„æ„Ÿã˜ã«è¿”å´ã—ãŸã„\n        - IDã«ç´ã¥ãã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãŒDBã‹ã‚‰å–ã‚Œãªã‹ã£ãŸ...ã¨ã‹\n        - 1å›ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã«å¯¾ã—ã¦Nå€‹ã®æ¥­å‹™ã‚¨ãƒ©ãƒ¼ã‚’è¿”ã—ãŸã„\n            - è¿”ã•ã‚ŒãŸæ¥­å‹™ã‚¨ãƒ©ãƒ¼ã‚’ãƒ•ãƒ­ãƒ³ãƒˆå´ã§è­˜åˆ¥ã—ã€å‡¦ç†ï¼ˆã‚¨ãƒ©ãƒ¼è¡¨ç¤ºã€ç„¡è¦–ãªã©ï¼‰ã‚’ãŠã“ãªã„ãŸã„\n    - ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¨ãƒ©ãƒ¼ç­‰ã¯ä¾‹å¤–ã§ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ã—ãŸã„\n\nä¸Šè¨˜ã®å®Ÿç¾ã«ã‚ãŸã‚ŠNestJSã®å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’ã¿ã¦ã„ãã¨ã€ [OpenAPI](https://docs.nestjs.com/openapi/introduction) ã®ç« ã®è¨˜è¿°ãŒå½¹ç«‹ã¡ãã†ã§ã™ãŒã€\nã‚„ã£ã¦ãã‚Œã‚‹ã®ã¯OpenAPIã®å®šç¾©ã‚’ç”Ÿæˆã—ã¦ãã‚Œã‚‹ã¨ã“ã‚ã¾ã§ãªã®ã§ã€ãã“ã‹ã‚‰APIã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã®ä½œæˆã¨ã€ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰å´ã‹ã‚‰ã®èª­ã¿è¾¼ã¿ã‚’ã©ã®ã‚ˆã†ã«è¡Œã†ã‹æ¤œè¨ã—ã¾ã—ãŸ\n\nãªãŠã€æœ¬ã‚¢ãƒ‰ãƒ™ãƒ³ãƒˆã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã§ã‚‚å‹å®‰å…¨ãªé€šä¿¡ã®æ–¹æ³•ã¨ã—ã¦ [GraphQLã‚’ä½¿ã£ãŸãƒ‘ã‚¿ãƒ¼ãƒ³](https://qiita.com/mikan3rd/items/3f46b1edcb79ad63deef) ã‚’æ›¸ã‹ã‚Œã¦ã„ã‚‹æ–¹ãŒã„ã¾ã™ã®ã§ã€ä½µã›ã¦ã”è¦§ã„ãŸã ãã¨æ¯”è¼ƒãŒã§ãã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“\nï¼ˆç§ã¯ã€é–‹ç™ºæ™‚ã«GraphQLã«å¯¾ã™ã‚‹çŸ¥è¦‹ãŒãªã‹ã£ãŸã®ã¨ã€ä½œã‚ŠãŸã„ã‚‚ã®ã«å¯¾ã—ã¦ã‚ªãƒ¼ãƒãƒ¼ã‚¹ãƒšãƒƒã‚¯æ°—å‘³ã«æ„Ÿã˜ãŸãŸã‚ä»Šå›ã¯æ¡ç”¨ã‚’è¦‹é€ã‚Šã¾ã—ãŸï¼‰\n\n# ä½œã£ãŸã‚‚ã®\n\nã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã¯ä»¥ä¸‹ã«ãªã‚Šã¾ã™ğŸ”\nã‚µãƒ³ãƒ—ãƒ«ã«ãªã‚Šãã†ãªéƒ¨åˆ†ã®ã¿æŠœãå‡ºã—ã¦ã„ã¾ã™\nhttps://github.com/yktakaha4/nestjs-typed-client\n\n`/backend` ã«NestJSã§ä½œã£ãŸãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã€ `/frontend` ã«Reactã§ä½œã£ãŸãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã®ã‚µãƒ³ãƒ—ãƒ«ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’æ ¼ç´ã—ã¦ã„ã¾ã™\nå®Ÿéš›ã«ä½œã£ãŸã‚‚ã®ã§ã¯åˆ¥ã€…ã®ãƒªãƒã‚¸ãƒˆãƒªã«ã¦ç®¡ç†ã—ã¦ã„ã¾ã™ãŒã€ä»Šå›ã¯ç°¡ä¾¿ã®ãŸã‚ã²ã¨ã¤ã«ã¾ã¨ã‚ã¾ã—ãŸ\n\nã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã®ç”Ÿæˆã‹ã‚‰ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã®å–ã‚Šè¾¼ã¿ã‚’å›³ã«ã—ãŸã‚‚ã®ã¯ä»¥ä¸‹ã«ãªã‚Šã¾ã™ğŸ¦‘\nã‚°ãƒ¬ãƒ¼ã®ç‚¹ç·šãŒã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã®é–¢é€£ã€ã‚ªãƒ¬ãƒ³ã‚¸ã®ç‚¹ç·šãŒå®Ÿéš›ã®é€šä¿¡ã®é–¢é€£ã®ã‚¤ãƒ¡ãƒ¼ã‚¸ã§ã™\n\n![archtecture.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/106259/f67d6809-04e5-7323-3167-65d24a3787d3.png)\n\næµã‚Œã¯ã“ã‚“ãªæ„Ÿã˜ã«ãªã‚Šã¾ã™\nãªãŠã€ä»Šå›ã¯ 2.ã§ç”Ÿæˆã™ã‚‹ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã« `typescript-axios` ã‚’é¸æŠã—ã¾ã—ãŸãŒã€ [ã“ã¡ã‚‰](https://github.com/OpenAPITools/openapi-generator/tree/master/docs/generators#client-generators) ã«è¨˜è¼‰ã•ã‚Œã¦ã„ã‚‹ã‚‚ã®ã‹ã‚‰ä»»æ„ã«é¸æŠå¯èƒ½ã§ã™\n\n1. NestJSã«ã¦ [@nestjs/swagger](https://github.com/nestjs/swagger) ã«ã¦ã‚¢ãƒãƒ†ãƒ¼ãƒˆã—ãŸDTOã¨ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã‚’å®šç¾©ã—ã€OpenAPIã®yamlãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç”Ÿæˆã™ã‚‹\n2. [@openapitools/openapi-generator-cli](https://github.com/OpenAPITools/openapi-generator-cli) ã«ã¦ã€1.ã§ä½œæˆã—ãŸyamlãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰TypeScriptã®APIã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚’ç”Ÿæˆã™ã‚‹\n3. GitHub Actionsã‚’ç”¨ã„ã¦ã€tagãŒpushã•ã‚ŒãŸï¼ˆâ‰’Releaseã‚’ä½œæˆã—ãŸï¼‰æ™‚ã€APIã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚’tscã«ã¦ãƒ“ãƒ«ãƒ‰ã— `GitHub Packages Registry` ã«ç™»éŒ²ã™ã‚‹\n4. ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã‹ã‚‰ `npm install @xxxxx/sample-backend-client` ã®å½¢ã§èª­ã¿è¾¼ã‚“ã§åˆ©ç”¨ã™ã‚‹\n\n## ã‚¢ãƒãƒ†ãƒ¼ãƒˆã—ãŸDTOã¨ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã®å®šç¾©\n\nãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰å´ã§ä»¥ä¸‹ã®ã‚ˆã†ã«ãƒªã‚¯ã‚¨ã‚¹ãƒˆã€ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’å®šç¾©ã—ã¾ã™\né•·ããªã‚‹ã®ã§ä¸€éƒ¨ã®ã¿æŠœç²‹ã—ã¾ã™ãŒã€ã‚¨ãƒ©ãƒ¼ã‚¯ãƒ©ã‚¹ã¯[ã“ã¡ã‚‰](https://github.com/yktakaha4/nestjs-typed-client/blob/master/backend/src/app.error.ts)ã®ã‚ˆã†ã«å®šç¾©ã—ã¦ã„ã¾ã™\n\n```typescript:ã‚¨ãƒ©ãƒ¼ã‚¯ãƒ©ã‚¹ã®å®šç¾©ï¼ˆãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ï¼‰\nexport class EmptyNameError {\n  // ç©ºã®åå‰ã‚’ç¤ºã™ã‚¨ãƒ©ãƒ¼ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ\n\n  @ApiProperty({ enum: EmptyNameErrorType })\n  readonly type = EmptyNameErrorType.Value;\n\n  @ApiProperty({ enum: GreetParameter })\n  readonly parameter: GreetParameter;\n\n  constructor(parameter: GreetParameter) {\n    this.parameter = parameter;\n  }\n}\n\nexport class VulgarNameError {\n  // ä¸‹å“ãªåå‰ã‚’ç¤ºã™ã‚¨ãƒ©ãƒ¼ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ\n\n  @ApiProperty({ enum: VulgarNameErrorType })\n  readonly type = VulgarNameErrorType.Value;\n\n  @ApiProperty({ enum: GreetParameter })\n  readonly parameter: GreetParameter;\n\n  @ApiProperty()\n  readonly vulgarWord: string;\n\n  constructor(parameter: GreetParameter, vulgarWord: string) {\n    this.parameter = parameter;\n    this.vulgarWord = vulgarWord;\n  }\n}\n\nexport type GreetErrors = Array<EmptyNameError | VulgarNameError>;\n```\n\n```typescript:ã‚¯ãƒ©ã‚¹ã¸ã®ã‚¢ãƒãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ï¼‰\nexport class GreetRequest {\n  @ApiProperty()\n  readonly lastName: string;\n\n  @ApiProperty()\n  readonly firstName: string;\n\n  constructor(lastName: string, firstName: string) {\n    this.lastName = lastName;\n    this.firstName = firstName;\n  }\n}\n\n@ApiExtraModels(EmptyNameError, VulgarNameError)\nexport class GreetResponse {\n  @ApiProperty({ type: String, nullable: true })\n  readonly message: string | null;\n\n  @ApiProperty({\n    type: 'array',\n    items: { oneOf: greetErrorSchemaPaths },\n  })\n  readonly errors: GreetErrors;\n\n  constructor(message: string | null, errors: GreetErrors) {\n    this.message = message;\n    this.errors = errors;\n  }\n}\n```\n\nã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã®ã‚µãƒ³ãƒ—ãƒ«ã§ã™\n`@ApiOkResponse` ã«ã‚ˆã£ã¦ã‚¢ãƒãƒ†ãƒ¼ãƒˆã—ãŸDTOã‚’æŒ‡å®šã—ã¾ã™ã€‚ `@ApiOperation` ã§ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã«ç”Ÿæˆã•ã‚Œã‚‹ãƒ¡ã‚½ãƒƒãƒ‰åã‚’æŒ‡å®šã§ãã¾ã™\n\n```typescript:ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆï¼ˆãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ï¼‰\n@ApiTags('App')\n@Controller()\nexport class AppController {\n  constructor(private readonly appService: AppService) {}\n\n  @ApiOkResponse({ type: GreetResponse })\n  @ApiOperation({ operationId: 'greet' })\n  @Post('greet')\n  @HttpCode(200)\n  greet(@Body() request: GreetRequest): GreetResponse {\n    // å…¥åŠ›ãƒã‚§ãƒƒã‚¯\n    const errors = this.appService.validateGreetRequest(request);\n\n    let message: string | null = null;\n    if (errors.length === 0) {\n      // ã‚¨ãƒ©ãƒ¼ãªã—ã®å ´åˆã®ã¿ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å–å¾—\n      message = this.appService.getGreetingMessage(request);\n    }\n\n    return new GreetResponse(message, errors);\n  }\n}\n```\n\nNestJSã®ã‚³ãƒ¼ãƒ‰ã‹ã‚‰yamlãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç”Ÿæˆã™ã‚‹æ–¹æ³•ã¯[ã“ã¡ã‚‰](https://qiita.com/yktakaha4/items/97ea169ed97dbcdd25fb) ã§ã‚‚èª¬æ˜ã—ã¦ã„ã¾ã™\nã‚³ãƒãƒ³ãƒ‰ã¯ä»¥ä¸‹\n\n```terminal\n$ cd ./backend\n$ npm run openapi:export\n```\n\n## yamlãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆç”Ÿæˆ\n\nãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã®ã‚³ãƒ¼ãƒ‰ã¨ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’åˆ†ã‘ã‚‹ãŸã‚ã€ `./backend/client` é…ä¸‹ã«npmãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ç”¨ã®ä¸€å¼ã‚’æ ¼ç´ã—ã¦ã„ã¾ã™\n\n```terminal\n$ cd ./backend/client\n$ npm ci\n$ npm run generate\n$ npm run build\n\n# run generateæ™‚ã«å®Ÿè¡Œã•ã‚Œã‚‹ã‚³ãƒãƒ³ãƒ‰\n# ã‚ªãƒ—ã‚·ãƒ§ãƒ³ç­‰ã¯ä»¥ä¸‹å‚ç…§\n# https://github.com/OpenAPITools/openapi-generator/blob/master/docs/generators/typescript-axios.md\n# JAVA_OPTS=\"-Dlog.level=warn\" openapi-generator generate -i sample-backend.yml -o lib/ -g typescript-axios --api-package=api --model-package=models --additional-properties=supportsES6=true,withSeparateModelsAndApi=true\n```\n\n## npmãƒ‘ãƒƒã‚±ãƒ¼ã‚¸å…¬é–‹\n\nGitHub Actionsã«ã¦ã€ `client.*` ã¨ã„ã†å½¢å¼ã®ã‚¿ã‚°ãŒæ‰“ãŸã‚ŒãŸã‚‰ä»¥ä¸‹ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã‚’å®Ÿè¡Œã™ã‚‹ã‚ˆã†ã«ã—ã¾ã™\nnpm publishæ™‚ã«ã€ç”Ÿæˆã—ãŸãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³åã‚’ä¸€æ„ã«ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã®ã§ã€ä»Šå›ã¯[ã“ã¡ã‚‰](https://github.com/yktakaha4/nestjs-typed-client/blob/master/backend/client/set-package-version.js)ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ä½¿ã£ã¦å®Ÿç¾ã—ã¦ã„ã¾ã™\nä»Šå›ã¯ã€ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå´ã§èª­ã¿è¾¼ã‚“ã§ã„ã‚‹ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®ä¸€æ„æ€§ã‚’ä¿è¨¼ã§ãã‚Œã°ååˆ†ã ã£ãŸã®ã§ã€ã‚»ãƒãƒ³ãƒ†ã‚£ãƒƒã‚¯ãƒãƒ¼ã‚¸ãƒ§ãƒ‹ãƒ³ã‚°ã¯è€ƒæ…®ã›ãšã«ã€ `0.0.1-${ã‚¿ã‚°å}` ã®å½¢å¼ã§å…¬é–‹ã™ã‚‹ã‚ˆã†ã«ã—ã¾ã—ãŸ\n\nã¡ãªã¿ã«ã€ãƒˆãƒ¼ã‚¯ãƒ³ã«ã¤ã„ã¦ã¯ã€GitHub ActionsãŒãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§æŒ‡å®šã—ã¦ãã‚Œã‚‹ã‚‚ã®ã§å•é¡Œã‚ã‚Šã¾ã›ã‚“\nï¼ˆãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆãƒªãƒã‚¸ãƒˆãƒªã®å ´åˆã€ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®èª­ã¿è¾¼ã¿ã‚’è¡Œã†å´ã§ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®èª­ã¿è¾¼ã¿æ¨©é™ã®ã‚ã‚‹ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ã®ç™ºè¡ŒãŒå¿…è¦ã«ãªã‚Šã¾ã™ï¼‰\n\n```yaml:publish-client.yml\nname: Publish client\n\non:\n  push:\n    tags:\n      - client.*\n\njobs:\n  publish:\n    name: Publish client\n    runs-on: ubuntu-18.04\n    timeout-minutes: 3\n    steps:\n      - uses: actions/checkout@v2\n\n      - uses: actions/setup-node@v1\n        with:\n          node-version: 12.x\n          registry-url: https://npm.pkg.github.com/\n          scope: \"@yktakaha4\"\n\n      - run: npm ci\n        working-directory: ./backend\n\n      - run: npm run openapi:export\n        working-directory: ./backend\n\n      - run: npm ci\n        working-directory: ./backend/client\n\n      - run: npm run version $GH_REF\n        working-directory: ./backend/client\n        env:\n          GH_REF: ${{ github.ref }}\n\n      - run: npm publish\n        working-directory: ./backend/client\n        env:\n          NODE_AUTH_TOKEN: ${{ secrets.GITHUB_TOKEN }}\n```\n\nä¸Šè¨˜ã«åŸºã¥ã„ã¦ç”Ÿæˆã•ã‚ŒãŸnpmãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã¯ã€[ã“ã¡ã‚‰](https://github.com/yktakaha4/nestjs-typed-client/packages/) ã«ã¦å…¬é–‹ã•ã‚Œã¾ã™\n\n# Demo\n\nä»¥ä¸‹ã®æ–¹æ³•ã§èµ·å‹•ã§ãã¾ã™\nãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã¯ `localhost:3100`ã€ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã¯ `localhost:3000` ã§èµ·å‹•ã—ã¾ã™\n\n```terminal:ã‚¿ãƒ¼ãƒŸãƒŠãƒ«\n# ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã‚’èµ·å‹•\n$ cd ./backend\n$ npm ci\n$ npm run start\n\n# ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã‚’èµ·å‹•ï¼ˆåˆ¥ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã«ã¦ï¼‰\n$ cd ./frontend\n$ yarn install\n$ yarn start\n```\n\nãƒ†ã‚­ã‚¹ãƒˆãƒœãƒƒã‚¯ã‚¹ã«è‹—å­—ã€åå‰ã‚’å…¥åŠ›ã—ã¦ `Greet` ãƒœã‚¿ãƒ³ã‚’æŠ¼ã™ã¨ã€æŒ¨æ‹¶ãŒè¿”å´ã•ã‚Œã¾ã™ğŸ‘‹\n\n![åå‰ã‚’å…¥åŠ›](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/106259/038f1105-8a75-ed5b-a9b0-80be97db3482.png)\n\nãƒªã‚¯ã‚¨ã‚¹ãƒˆã¨ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã¯ãã‚Œãã‚Œã“ã‚“ãªæ„Ÿã˜ã®ã‚‚ã®ãŒé€å—ã•ã‚Œã¾ã™\n\n```json:Request\n{\n  \"lastName\": \"yuuki\",\n  \"firstName\": \"takahashi\"\n}\n```\n\n```json:Response\n{\n  \"message\": \"Hello, Yuuki TAKAHASHI !\",\n  \"errors\": []\n}\n```\n\nãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã‹ã‚‰ã®APIå‘¼ã³å‡ºã—ã¯ã“ã‚“ãªæ„Ÿã˜ã«ãªã‚Šã¾ã™\n\n```typescript:å‘¼ã³å‡ºã—ã‚µãƒ³ãƒ—ãƒ«ï¼ˆãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ï¼‰\n// AppApiã‚¯ãƒ©ã‚¹ã¯ npmãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‹ã‚‰ã‚¤ãƒ³ãƒãƒ¼ãƒˆã—ãŸã‚‚ã®ï¼ˆè‡ªå‹•ç”Ÿæˆï¼‰\nconst api = new AppApi();\n\napi.greet(greetingRequest).then((axiosResponse) => {\n  dispatchResponse(axiosResponse.data);\n}).catch((error) => {\n  dispatch({ type: 'UPDATE_MESSAGE', value: String(error) });\n});\n```\n\nã‚¤ãƒ³ãƒ†ãƒªã‚»ãƒ³ã‚¹ãŒã¡ã‚ƒã‚“ã¨åŠ¹ã„ã¦ã¾ã™\n\n![ã‚¤ãƒ³ãƒ†ãƒªã‚»ãƒ³ã‚¹](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/106259/37961523-b9e3-fc46-3b0e-7a96fbbbeefa.png)\n\nå…¥åŠ›ã‚¨ãƒ©ãƒ¼ï¼ˆå€¤ãŒç©º or ä¸‹å“ãªè¨€è‘‰ãŒå…¥åŠ›ã•ã‚Œã¦ã„ã‚‹ï¼‰ã‚’ã‚µãƒ¼ãƒã‚µã‚¤ãƒ‰ã§æ¤œè¨¼ã—ã€ã‚¨ãƒ©ãƒ¼ã®å ´åˆã¯ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã«ã¦ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ç·¨é›†ã—ã¾ã™\n\n![å…¥åŠ›ã‚¨ãƒ©ãƒ¼](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/106259/b5ca5c49-32a1-8283-90a6-880b2fccb6c1.png)\n\n```json:Response\n{\n  \"message\": null,\n  \"errors\": [\n    {\n      \"type\": \"EmptyNameError\",\n      \"parameter\": \"LastName\"\n    },\n    {\n      \"type\": \"VulgarNameError\",\n      \"parameter\": \"FirstName\",\n      \"vulgarWord\": \"shit\"\n    }\n  ]\n}\n```\n\nã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ç·¨é›†ã®ã‚µãƒ³ãƒ—ãƒ«ã¯ä»¥ä¸‹ã«ãªã‚Šã¾ã™\nã“ã®ã‚³ãƒ¼ãƒ‰ã ã‘ã§ã¯ã‚ã‹ã‚Šã¥ã‚‰ã„ã§ã™ãŒã€ `type` ã‚‚ `parameter` ã‚‚å‹ä»˜ã‘ã•ã‚Œã¦ãŠã‚Šã€ã¾ãŸ [å‹ã‚¬ãƒ¼ãƒ‰](https://typescript-jp.gitbook.io/deep-dive/type-system/typeguard) ã®åŠ¹æœã«ã‚ˆã‚Š `VulgarNameError` ã®åˆ¤å®šæ–‡ã®ä¸­ã§ã¯ `vulgarWord` ãŒå‚ç…§ã§ãã¦ã„ã¾ã™ğŸŒ¿\n\n```typescript:ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸è¨­å®šã‚µãƒ³ãƒ—ãƒ«ï¼ˆãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ï¼‰\nconst dispatchResponse = (response: GreetResponse) => {\n  if (response.message) {\n    // ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè¿”å´ã•ã‚ŒãŸå ´åˆã¯ãã‚Œã‚’è¨­å®š\n    dispatch({ type: 'UPDATE_MESSAGE', value: response.message });\n  } else {\n    // ã•ã‚Œãªã‹ã£ãŸå ´åˆã¯ã€ã‚¨ãƒ©ãƒ¼ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«åˆã‚ã›ã¦è¨­å®š\n    const messages: Array<string> = [];\n    for (const error of response.errors) {\n      if (error.type === 'EmptyNameError') {\n        if (error.parameter === 'LastName') {\n          messages.push('ãƒ»åå‰ã¯ç©ºã«ã§ãã¾ã›ã‚“');\n        } else if (error.parameter === 'FirstName') {\n          messages.push('ãƒ»è‹—å­—ã¯ç©ºã«ã§ãã¾ã›ã‚“');\n        }\n      } else if (error.type === 'VulgarNameError') {\n        if (error.parameter === 'LastName') {\n          messages.push(`ãƒ»åå‰ã« ${error.vulgarWord} ã¯è¨­å®šã§ãã¾ã›ã‚“`);\n        } else if (error.parameter === 'FirstName') {\n          messages.push(`ãƒ»è‹—å­—ã« ${error.vulgarWord} ã¯è¨­å®šã§ãã¾ã›ã‚“`);\n        }\n      }\n    }\n\n    dispatch({ type: 'UPDATE_MESSAGE', value: messages.join('') });\n  }\n};\n```\n\nä¸€ã¤æ®‹å¿µãªã®ã¯ã€ç¾æ™‚ç‚¹ã§ã®OpenAPIv3ã§ã¯ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ä¸Šã§ãƒªãƒ†ãƒ©ãƒ«å€¤ã‚’è¡¨ç¾ã§ããªã„ãŸã‚ã€ï¼ˆ[ã“ã¡ã‚‰ã®Constant Parametersã®é …ã®ã‚ˆã†ã«ã€å˜ä¸€ã®ãƒ¡ãƒ³ãƒã‚’æŒã¤Enumã¨ã—ã¦å®šç¾©ã™ã‚‹å¿…è¦ã‚ã‚Š](https://swagger.io/docs/specification/describing-parameters/)ï¼‰\nä¸Šè¨˜ã®å‹ã‚¬ãƒ¼ãƒ‰ã‚’å®Ÿç¾ã™ã‚‹ã«ã‚ãŸã‚Šã€ `type` ã‚’ `'EmptyNameError' | 'VulgarNameError'` ã®ã‚ˆã†ãªstringã®Unionå‹ã§ã¯å®šç¾©ã§ããšã€è‡ªå‹•ç”Ÿæˆã•ã‚Œã‚‹ã‚³ãƒ¼ãƒ‰ã¯ `EmptyNameErrorTypeEnum | VulgarNameErrorTypeEnum` ã®ã‚ˆã†ãªå½¢ã«ãªã‚‹ãŸã‚ã€ã‚¤ãƒ³ãƒ†ãƒªã‚»ãƒ³ã‚¹ã‚’åŠ¹ã‹ã›ã‚‹ã“ã¨ãŒã§ããšã«ã„ã¾ã™\nå€¤ã®æ¤œè¨¼ã¯æ­£ã—ãã§ãã‚‹ãŸã‚ã€ã“ã‚Œã§ã‚‚å•é¡Œã¯ãªã„ã§ã™ãŒ...\nï¼ˆç§ã®ç†è§£ä¸è¶³ãªã ã‘ã§ã€ã„ã„ã‚„ã‚Šæ–¹ãŒã§ãã‚‹æ°—ã¯ã‚‚ã®ã™ã”ãã—ã¾ã™ğŸ™ƒï¼‰\n\nã‚ã¨ã€ä»Šå›ã¯æœ¬æ—¨ã‹ã‚‰å¤–ã‚Œã‚‹ãŸã‚å‰²æ„›ã—ã¦ã„ã¾ã™ãŒã€é …ç›®æ¯ã®ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã«ã¤ã„ã¦ã¯[ã“ã¡ã‚‰](https://docs.nestjs.com/techniques/validation#validation)ã‚’ä½¿ã†ã¨ã„ã„æ„Ÿã˜ã«ã§ãã‚‹ã®ã§ã€ä½µã›ã¦å°å…¥ã‚’ã‚ªã‚¹ã‚¹ãƒ¡ã—ã¾ã™\n\n# ã¾ã¨ã‚\n\nã²ã¨ã¤ã„ã„å®Ÿè£…ãƒ‘ã‚¿ãƒ¼ãƒ³ãŒä½œã‚ŒãŸæ°—ãŒã™ã‚‹ã®ã§ã€ä»–ã®ã‚„ã‚Šæ–¹ï¼ˆå…ˆã»ã©èª¬æ˜ã—ãŸGraphQLã‚„ã€[frourio](https://github.com/frouriojs/frourio)ãªã‚“ã‹ã‚‚ãã†ãªã‚“ã§ã—ã‚‡ã†ã‹ï¼Ÿï¼‰ã«ã¤ã„ã¦ã‚‚æŒ‘æˆ¦ã—ã¦ã„ããŸã„ã¨æ€ã„ã¾ã™ï¼\n",
    "coediting": false,
    "comments_count": 0,
    "created_at": "2020-12-10T03:06:46+09:00",
    "group": null,
    "id": "0aecde44848d6a861bf5",
    "likes_count": 15,
    "private": false,
    "reactions_count": 0,
    "stocks_count": 9,
    "tags": [
      {
        "name": "npm",
        "versions": []
      },
      {
        "name": "TypeScript",
        "versions": []
      },
      {
        "name": "OpenAPI",
        "versions": []
      },
      {
        "name": "NestJS",
        "versions": []
      },
      {
        "name": "GitHubActions",
        "versions": []
      }
    ],
    "title": "NestJS + OpenAPI(Swagger)ã‹ã‚‰APIã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚’ç”Ÿæˆã—å‹å®‰å…¨ã«é€šä¿¡ã™ã‚‹",
    "updated_at": "2020-12-14T07:03:00+09:00",
    "url": "https://qiita.com/yktakaha4/items/0aecde44848d6a861bf5",
    "user": {
      "description": "",
      "facebook_id": "",
      "followees_count": 26,
      "followers_count": 22,
      "github_login_name": "yktakaha4",
      "id": "yktakaha4",
      "items_count": 27,
      "linkedin_id": "",
      "location": "",
      "name": "Yuuki Takahashi",
      "organization": "LAPRASæ ªå¼ä¼šç¤¾",
      "permanent_id": 106259,
      "profile_image_url": "https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/106259/profile-images/1600489516",
      "team_only": false,
      "twitter_screen_name": "yktakaha4",
      "website_url": "https://yktakaha4.github.io/"
    },
    "page_views_count": null,
    "team_membership": null,
    "organization_url_name": null,
    "slide": false
  }
]
